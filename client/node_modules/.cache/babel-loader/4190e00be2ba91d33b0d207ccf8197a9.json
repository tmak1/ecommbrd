{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{useState,useRef}from'react';import{useHistory}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import{Formik,Form}from'formik';import*as Yup from'yup';import PageHeading from'../../shared/ui/PageHeading';import FormikTextField from'../../shared/formElements/FormikTextField';import ImageUpload from'../../shared/formElements/ImageUpload';import LoadingLinear from'../../shared/ui/LoadingLinear';import AlertMessage from'../../shared/ui/AlertMessage';import{createProduct}from'../../../redux/actionCreators/productActionCreators';import categories from'../../../categories';import{makeStyles}from'@material-ui/core/styles';import Paper from'@material-ui/core/Paper';import Button from'@material-ui/core/Button';import TextField from'@material-ui/core/TextField';import IconButton from'@material-ui/core/IconButton';import Tooltip from'@material-ui/core/Tooltip';import Zoom from'@material-ui/core/Zoom';import RefreshIcon from'@material-ui/icons/Refresh';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{root:{minWidth:'600px',padding:'20px',margin:'0 auto',textAlign:'center'},btn:{margin:'30px auto 10px auto',padding:'12px',backgroundColor:theme.palette.primary.dark,fontSize:'14px',fontWeight:'700',borderRadius:'0',color:'#fff','&:hover':{backgroundColor:theme.palette.primary.main}},iconButtonDiv:{display:'flex',justifyContent:'space-between'},select:_defineProperty({},theme.breakpoints.down('xs'),{width:theme.spacing(4),height:theme.spacing(4),fontSize:'13px'}),previewBox:{margin:'0 auto','&>img':{width:'250px',height:'250px'}}};});var CreateProduct=function CreateProduct(){var classes=useStyles();var history=useHistory();var dispatch=useDispatch();var ref=useRef();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loadingImageUpload=_useState2[0],setLoadingImageUpload=_useState2[1];var _useSelector=useSelector(function(state){return state.productDelete||{};}),loadingDelete=_useSelector.loading;var _useSelector2=useSelector(function(state){return state.productCreate||{};}),loadingUpdate=_useSelector2.loading;var _useSelector3=useSelector(function(state){return state.userAuth;}),loggedInUser=_useSelector3.loggedInUser;var _useSelector4=useSelector(function(state){return state.productCreate||{};}),loading=_useSelector4.loading,error=_useSelector4.error;var initialValues={name:'Placeholder name',price:1,countInStock:1,description:'Placeholder description',brand:'Placeholder brand',category:categories[0]};var validationSchema=Yup.object({name:Yup.string().required('Name required'),price:Yup.number('Must be a number').required('Price required').positive('Must be positive'),countInStock:Yup.number('Must be a number').required('Count in Stock required').positive('Must be positive').integer('No decimal points'),description:Yup.string().required('Description required'),brand:Yup.string().required('Brand required'),category:Yup.string().required('Category required').oneOf(categories)});var onSuccess=function onSuccess(){history.goBack();};var submitHandler=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values,actions){var imageUrl,productInfo;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;setLoadingImageUpload(true);_context.next=4;return ref.current.handleUpload(values.name);case 4:imageUrl=_context.sent;_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:_context.prev=10;setLoadingImageUpload(false);return _context.finish(10);case 13:productInfo={name:values.name,price:values.price,countInStock:values.countInStock,imageUrl:imageUrl||'/images/placeholder.js',description:values.description,brand:values.brand,category:values.category};console.log(productInfo);dispatch(createProduct(loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token,productInfo,onSuccess));actions.setSubmitting(false);case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,7,10,13]]);}));return function submitHandler(_x,_x2){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(PageHeading,{text:\"CREATE PRODUCT\",paragraph:true,size:\"medium\"}),(loading||loadingImageUpload||loadingDelete||loadingUpdate)&&/*#__PURE__*/_jsx(LoadingLinear,{}),error&&/*#__PURE__*/_jsx(AlertMessage,{message:error,severity:\"error\",variant:\"outlined\"}),/*#__PURE__*/_jsx(Paper,{className:classes.root,elevation:0,children:/*#__PURE__*/_jsx(Formik,{initialValues:initialValues,validationSchema:validationSchema,onSubmit:submitHandler,validateOnMount:true,enableReinitialize:true,children:function children(formik){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.iconButtonDiv,children:[/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(Tooltip,{TransitionComponent:Zoom,title:\"Reset form\",children:/*#__PURE__*/_jsx(IconButton,{color:\"primary\",onClick:function onClick(){return formik.resetForm();},children:/*#__PURE__*/_jsx(RefreshIcon,{})})})]}),/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsx(\"div\",{className:classes.formControl,children:/*#__PURE__*/_jsx(FormikTextField,{fieldName:\"name\",type:\"text\",label:\"Name\",variant:\"outlined\",values:formik.initialValues.name})}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:'center'},children:/*#__PURE__*/_jsx(ImageUpload,{token:loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token,ref:ref})}),/*#__PURE__*/_jsx(\"div\",{className:classes.formControl,children:/*#__PURE__*/_jsx(FormikTextField,{fieldName:\"price\",type:\"number\",label:\"Price\",variant:\"outlined\",adornmentPosition:\"start\",adornment:\"$ \",values:formik.initialValues.price})}),/*#__PURE__*/_jsx(\"div\",{className:classes.formControl,children:/*#__PURE__*/_jsx(FormikTextField,{fieldName:\"countInStock\",type:\"number\",label:\"Count in Stock\",variant:\"outlined\",values:formik.initialValues.countInStock})}),/*#__PURE__*/_jsx(\"div\",{className:classes.formControl,children:/*#__PURE__*/_jsx(FormikTextField,{fieldName:\"description\",type:\"text\",label:\"Description\",variant:\"outlined\",multiline:true,rows:3,values:formik.initialValues.description})}),/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'left',margin:'30px'},children:/*#__PURE__*/_jsx(TextField,{className:classes.select,select:true,label:\"Category\",onChange:function onChange(event){return formik.setFieldValue('category',event.target.value);},value:formik.values.category||formik.initialValues.category,SelectProps:{native:true},variant:\"outlined\",children:categories.map(function(category){return/*#__PURE__*/_jsx(\"option\",{value:category,children:category},category);})})}),/*#__PURE__*/_jsx(\"div\",{className:classes.formControl,children:/*#__PURE__*/_jsx(FormikTextField,{fieldName:\"brand\",type:\"text\",label:\"Brand\",variant:\"outlined\",values:formik.initialValues.brand})}),/*#__PURE__*/_jsx(Button,{style:{width:'200px'},type:\"submit\",disabled:!formik.isValid||formik.isSubmitting,variant:\"contained\",disableElevation:true,className:classes.btn,children:\"CREATE\"})]})]});}})})]});};export default CreateProduct;","map":{"version":3,"sources":["/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/src/components/products/pages/CreateProduct.js"],"names":["React","useState","useRef","useHistory","useDispatch","useSelector","Formik","Form","Yup","PageHeading","FormikTextField","ImageUpload","LoadingLinear","AlertMessage","createProduct","categories","makeStyles","Paper","Button","TextField","IconButton","Tooltip","Zoom","RefreshIcon","useStyles","theme","root","minWidth","padding","margin","textAlign","btn","backgroundColor","palette","primary","dark","fontSize","fontWeight","borderRadius","color","main","iconButtonDiv","display","justifyContent","select","breakpoints","down","width","spacing","height","previewBox","CreateProduct","classes","history","dispatch","ref","loadingImageUpload","setLoadingImageUpload","state","productDelete","loadingDelete","loading","productCreate","loadingUpdate","userAuth","loggedInUser","error","initialValues","name","price","countInStock","description","brand","category","validationSchema","object","string","required","number","positive","integer","oneOf","onSuccess","goBack","submitHandler","values","actions","current","handleUpload","imageUrl","console","log","productInfo","token","setSubmitting","formik","resetForm","formControl","event","setFieldValue","target","value","native","map","isValid","isSubmitting"],"mappings":"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","sourcesContent":["import React, { useState, useRef } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Formik, Form } from 'formik';\nimport * as Yup from 'yup';\n\nimport PageHeading from '../../shared/ui/PageHeading';\nimport FormikTextField from '../../shared/formElements/FormikTextField';\nimport ImageUpload from '../../shared/formElements/ImageUpload';\nimport LoadingLinear from '../../shared/ui/LoadingLinear';\nimport AlertMessage from '../../shared/ui/AlertMessage';\n\nimport { createProduct } from '../../../redux/actionCreators/productActionCreators';\n\nimport categories from '../../../categories';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Zoom from '@material-ui/core/Zoom';\n\nimport RefreshIcon from '@material-ui/icons/Refresh';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    minWidth: '600px',\n    padding: '20px',\n    margin: '0 auto',\n    textAlign: 'center',\n  },\n  btn: {\n    margin: '30px auto 10px auto',\n    padding: '12px',\n    backgroundColor: theme.palette.primary.dark,\n    fontSize: '14px',\n    fontWeight: '700',\n    borderRadius: '0',\n    color: '#fff',\n    '&:hover': {\n      backgroundColor: theme.palette.primary.main,\n    },\n  },\n  iconButtonDiv: {\n    display: 'flex',\n    justifyContent: 'space-between',\n  },\n  select: {\n    [theme.breakpoints.down('xs')]: {\n      width: theme.spacing(4),\n      height: theme.spacing(4),\n      fontSize: '13px',\n    },\n  },\n  previewBox: {\n    margin: '0 auto',\n    '&>img': {\n      width: '250px',\n      height: '250px',\n    },\n  },\n}));\n\nconst CreateProduct = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const ref = useRef();\n  const [loadingImageUpload, setLoadingImageUpload] = useState(false);\n  const { loading: loadingDelete } = useSelector(\n    (state) => state.productDelete || {}\n  );\n  const { loading: loadingUpdate } = useSelector(\n    (state) => state.productCreate || {}\n  );\n  const { loggedInUser } = useSelector((state) => state.userAuth);\n  const { loading, error } = useSelector((state) => state.productCreate || {});\n  const initialValues = {\n    name: 'Placeholder name',\n    price: 1,\n    countInStock: 1,\n    description: 'Placeholder description',\n    brand: 'Placeholder brand',\n    category: categories[0],\n  };\n  const validationSchema = Yup.object({\n    name: Yup.string().required('Name required'),\n    price: Yup.number('Must be a number')\n      .required('Price required')\n      .positive('Must be positive'),\n    countInStock: Yup.number('Must be a number')\n      .required('Count in Stock required')\n      .positive('Must be positive')\n      .integer('No decimal points'),\n    description: Yup.string().required('Description required'),\n    brand: Yup.string().required('Brand required'),\n    category: Yup.string().required('Category required').oneOf(categories),\n  });\n\n  const onSuccess = () => {\n    history.goBack();\n  };\n  const submitHandler = async (values, actions) => {\n    let imageUrl;\n    try {\n      setLoadingImageUpload(true);\n      imageUrl = await ref.current.handleUpload(values.name);\n    } catch (error) {\n      console.log(error);\n    } finally {\n      setLoadingImageUpload(false);\n    }\n    const productInfo = {\n      name: values.name,\n      price: values.price,\n      countInStock: values.countInStock,\n      imageUrl: imageUrl || '/images/placeholder.js',\n      description: values.description,\n      brand: values.brand,\n      category: values.category,\n    };\n    console.log(productInfo);\n    dispatch(createProduct(loggedInUser?.token, productInfo, onSuccess));\n    actions.setSubmitting(false);\n  };\n\n  return (\n    <>\n      <PageHeading text=\"CREATE PRODUCT\" paragraph size=\"medium\" />\n      {(loading || loadingImageUpload || loadingDelete || loadingUpdate) && (\n        <LoadingLinear />\n      )}\n      {error && (\n        <AlertMessage message={error} severity=\"error\" variant=\"outlined\" />\n      )}\n      <Paper className={classes.root} elevation={0}>\n        <Formik\n          initialValues={initialValues}\n          validationSchema={validationSchema}\n          onSubmit={submitHandler}\n          validateOnMount\n          enableReinitialize\n        >\n          {(formik) => (\n            <>\n              <div className={classes.iconButtonDiv}>\n                <div></div>\n                <Tooltip TransitionComponent={Zoom} title=\"Reset form\">\n                  <IconButton\n                    color=\"primary\"\n                    onClick={() => formik.resetForm()}\n                  >\n                    <RefreshIcon />\n                  </IconButton>\n                </Tooltip>\n              </div>\n              <Form>\n                <div className={classes.formControl}>\n                  <FormikTextField\n                    fieldName=\"name\"\n                    type=\"text\"\n                    label=\"Name\"\n                    variant=\"outlined\"\n                    values={formik.initialValues.name}\n                  />\n                </div>\n                <div style={{ display: 'flex', justifyContent: 'center' }}>\n                  <ImageUpload token={loggedInUser?.token} ref={ref} />\n                </div>\n                <div className={classes.formControl}>\n                  <FormikTextField\n                    fieldName=\"price\"\n                    type=\"number\"\n                    label=\"Price\"\n                    variant=\"outlined\"\n                    adornmentPosition=\"start\"\n                    adornment=\"$ \"\n                    values={formik.initialValues.price}\n                  />\n                </div>\n                <div className={classes.formControl}>\n                  <FormikTextField\n                    fieldName=\"countInStock\"\n                    type=\"number\"\n                    label=\"Count in Stock\"\n                    variant=\"outlined\"\n                    values={formik.initialValues.countInStock}\n                  />\n                </div>\n                <div className={classes.formControl}>\n                  <FormikTextField\n                    fieldName=\"description\"\n                    type=\"text\"\n                    label=\"Description\"\n                    variant=\"outlined\"\n                    multiline\n                    rows={3}\n                    values={formik.initialValues.description}\n                  />\n                </div>\n                <div style={{ textAlign: 'left', margin: '30px' }}>\n                  <TextField\n                    className={classes.select}\n                    select\n                    label=\"Category\"\n                    onChange={(event) =>\n                      formik.setFieldValue('category', event.target.value)\n                    }\n                    value={\n                      formik.values.category || formik.initialValues.category\n                    }\n                    SelectProps={{\n                      native: true,\n                    }}\n                    variant=\"outlined\"\n                  >\n                    {categories.map((category) => (\n                      <option key={category} value={category}>\n                        {category}\n                      </option>\n                    ))}\n                  </TextField>\n                </div>\n                <div className={classes.formControl}>\n                  <FormikTextField\n                    fieldName=\"brand\"\n                    type=\"text\"\n                    label=\"Brand\"\n                    variant=\"outlined\"\n                    values={formik.initialValues.brand}\n                  />\n                </div>\n                <Button\n                  style={{ width: '200px' }}\n                  type=\"submit\"\n                  disabled={!formik.isValid || formik.isSubmitting}\n                  variant=\"contained\"\n                  disableElevation\n                  className={classes.btn}\n                >\n                  CREATE\n                </Button>\n              </Form>\n            </>\n          )}\n        </Formik>\n      </Paper>\n    </>\n  );\n};\n\nexport default CreateProduct;\n"]},"metadata":{},"sourceType":"module"}