{"ast":null,"code":"import _toConsumableArray from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{useState,useEffect,useCallback}from'react';import{useHistory}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import PlaceOrderSummary from'../components/PlaceOrderSummary';import AlertMessage from'../../shared/ui/AlertMessage';import LoadingLinear from'../../shared/ui/LoadingLinear';import PageHeading from'../../shared/ui/PageHeading';import SkeletonCartBody from'../../shared/ui/skeletons/SkeletonCartBody';import{SkeletonPrice,SkeletonProductDescription}from'../../shared/ui/skeletons/SkeletonComponents';import{addressStringify,paymentMethodStringify}from'../../../helpers';import{addToCart,removeFromCart}from'../../../redux/actionCreators/cartActionCreators';import{placeOrder}from'../../../redux/actionCreators/orderActionCreators';import{makeStyles}from'@material-ui/core/styles';import Typography from'@material-ui/core/Typography';import Divider from'@material-ui/core/Divider';import Hidden from'@material-ui/core/Hidden';import Grid from'@material-ui/core/Grid';import TableContainer from'@material-ui/core/TableContainer';import Table from'@material-ui/core/Table';import TableHead from'@material-ui/core/TableHead';import TableBody from'@material-ui/core/TableBody';import TableRow from'@material-ui/core/TableRow';import TableCell from'@material-ui/core/TableCell';import Paper from'@material-ui/core/Paper';import CardMedia from'@material-ui/core/CardMedia';import IconButton from'@material-ui/core/IconButton';import FormControl from'@material-ui/core/FormControl';import Select from'@material-ui/core/Select';import Tooltip from'@material-ui/core/Tooltip';import Zoom from'@material-ui/core/Zoom';import DeleteIcon from'@material-ui/icons/Delete';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){var _root;return{root:(_root={margin:theme.spacing(8,0),marginBottom:theme.spacing(15)},_defineProperty(_root,theme.breakpoints.up('md'),{justifyContent:'center'}),_defineProperty(_root,theme.breakpoints.down('lg'),{justifyContent:'flex-end'}),_root),paper:{width:theme.spacing(10),height:theme.spacing(7)},media:{width:'100%',height:'100%'},subRoot:{margin:theme.spacing(6,0)},select:_defineProperty({},theme.breakpoints.down('xs'),{width:theme.spacing(4),height:theme.spacing(4),fontSize:'13px','&>svg':{display:'none'}})};});var PlaceOrder=function PlaceOrder(){var classes=useStyles();var history=useHistory();var dispatch=useDispatch();var _useState=useState(null),_useState2=_slicedToArray(_useState,2),newOrderId=_useState2[0],setNewOrderId=_useState2[1];var _useSelector=useSelector(function(state){return state.userAuth;}),_useSelector$loggedIn=_useSelector.loggedInUser,user=_useSelector$loggedIn.user,token=_useSelector$loggedIn.token;var _useSelector2=useSelector(function(state){return state.cart;}),cartLoading=_useSelector2.loading,cartError=_useSelector2.error,cartItems=_useSelector2.cartItems;var _useSelector3=useSelector(function(state){return state.checkout;}),shippingLoading=_useSelector3.loading,shippingError=_useSelector3.shippingError,selectedshipping=_useSelector3.selectedshipping;var _useSelector4=useSelector(function(state){return state.checkout;}),paymentLoading=_useSelector4.loading,paymentError=_useSelector4.paymentError,selectedpayment=_useSelector4.selectedpayment;var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),selShipping=_useState4[0],setSelShipping=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),selPayment=_useState6[0],setSelPayment=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),total=_useState8[0],setTotal=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),tax=_useState10[0],setTax=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),shippingCost=_useState12[0],setShippingCost=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),subTotal=_useState14[0],setSubTotal=_useState14[1];var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),disableBtn=_useState16[0],setDisableBtn=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),SDKReady=_useState18[0],setSDKReady=_useState18[1];var addToCartHandler=useCallback(function(pid,qty){dispatch(addToCart(pid,qty));},[dispatch]);var removeFromCartHandler=function removeFromCartHandler(pid){dispatch(removeFromCart(pid));};var calculateTotal=useCallback(function(){var total=cartItems.reduce(function(acc,product){return product.price*product.qty+acc;},0);setTotal(total);},[cartItems]);var calculateTax=useCallback(function(){var taxPercentage=10;var tax=total*(taxPercentage/100.0);setTax(tax);},[total]);var calculateShippingCost=useCallback(function(){switch(true){case cartItems.length<=0:setShippingCost(0);break;case cartItems.length>20:setShippingCost(0);break;case cartItems.length>10&&cartItems.length<=20:setShippingCost(15);break;case cartItems.length<10:setShippingCost(25);break;default:setShippingCost(0);break;}},[cartItems===null||cartItems===void 0?void 0:cartItems.length]);var calculateSubTotal=useCallback(function(){var subTotal=total+tax+shippingCost;setSubTotal(subTotal);},[shippingCost,tax,total]);var onSuccess=function onSuccess(newOrderId){if(newOrderId){setNewOrderId(newOrderId);}};var handlePlaceOrder=function handlePlaceOrder(paymentData){var modifiedCartItems=cartItems.map(function(item){var newItem=_objectSpread(_objectSpread({},item),{},{productId:item.id});delete newItem.id;delete newItem.creatorId;delete newItem.name;delete newItem.price;delete newItem.imageUrl;delete newItem.rating;delete newItem.numReviews;delete newItem.reviewIds;delete newItem.countInStock;delete newItem.description;delete newItem.brand;delete newItem.category;return newItem;});var paymentResult={payId:paymentData.id,status:paymentData.status,update_time:paymentData.update_time,email_address:paymentData.payer.email_address,amount:paymentData.purchase_units[0].amount.value};var values={shippingAddressId:selectedshipping.id,paymentMethodId:selectedpayment.id,orderItems:modifiedCartItems,buyer:user,paymentResult:paymentResult,token:token,tax:tax,shippingCost:shippingCost,total:total,subTotal:subTotal,isPaid:true,paidAt:new Date(),isDelivered:false,deliveredAt:null,onSuccess:onSuccess};// console.log('values: ', values);\ndispatch(placeOrder(values));};var addPaypalScript=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var script,res,_yield$res$json,clientId;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(process.env.REACT_APP_API_URL,\"/orders/paypalConfig\"),{headers:{Authorization:\"Bearer \".concat(token)}});case 3:res=_context.sent;_context.next=6;return res.json();case 6:_yield$res$json=_context.sent;clientId=_yield$res$json.clientId;script=document.createElement('script');script.src=\"https://www.paypal.com/sdk/js?client-id=\".concat(clientId,\"&currency=USD&disable-funding=credit,card&commit=true\");script.type='text/javascript';script.async=true;document.body.append(script);script.onload=function(){return setSDKReady(true);};_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 19:case\"end\":return _context.stop();}}},_callee,null,[[0,16]]);})),[token]);useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!token){_context2.next=3;break;}_context2.next=3;return addPaypalScript();case 3:case\"end\":return _context2.stop();}}},_callee2);}))();},[token,addPaypalScript]);useEffect(function(){if(!token||!cartItems||!selectedshipping||!selectedpayment||cartItems&&cartItems.length<=0){setDisableBtn(true);}},[token,cartItems,selectedshipping,selectedpayment]);useEffect(function(){if(selectedshipping){var shipping=addressStringify(selectedshipping);setSelShipping(shipping);}},[selectedshipping]);useEffect(function(){if(selectedpayment){var payment=paymentMethodStringify(selectedpayment);setSelPayment(payment);}},[selectedpayment]);useEffect(function(){calculateTotal();calculateShippingCost();},[cartItems,calculateTotal,calculateShippingCost]);useEffect(function(){calculateTax();},[total,calculateTax]);useEffect(function(){calculateSubTotal();},[total,tax,shippingCost,calculateSubTotal]);useEffect(function(){if(newOrderId){history.push(\"/orders/\".concat(newOrderId));}},[newOrderId,history]);if(!SDKReady){return/*#__PURE__*/_jsx(LoadingLinear,{});}return/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,className:classes.root,children:[/*#__PURE__*/_jsxs(Grid,{item:true,md:8,sm:12,xs:12,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.subRoot,children:[/*#__PURE__*/_jsx(PageHeading,{text:\"SHIPPING ADDRESS\",paragraph:true,size:\"medium\"}),shippingLoading&&/*#__PURE__*/_jsx(SkeletonProductDescription,{}),shippingError&&/*#__PURE__*/_jsx(AlertMessage,{message:shippingError,severity:\"error\",variant:\"outlined\"}),/*#__PURE__*/_jsx(Typography,{paragraph:true,gutterBottom:true,children:selShipping}),/*#__PURE__*/_jsx(Divider,{})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.subRoot,children:[/*#__PURE__*/_jsx(PageHeading,{text:\"PAYMENT METHOD\",paragraph:true,size:\"medium\"}),paymentLoading&&/*#__PURE__*/_jsx(SkeletonPrice,{}),paymentError&&/*#__PURE__*/_jsx(AlertMessage,{message:paymentError,severity:\"error\",variant:\"outlined\"}),/*#__PURE__*/_jsx(Typography,{paragraph:true,gutterBottom:true,children:selPayment}),/*#__PURE__*/_jsx(Divider,{})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(PageHeading,{text:\"ORDER ITEMS\",paragraph:true,size:\"medium\"}),cartLoading&&/*#__PURE__*/_jsx(SkeletonCartBody,{}),cartError&&/*#__PURE__*/_jsx(AlertMessage,{message:cartError,severity:\"error\",variant:\"outlined\"}),(cartItems===null||cartItems===void 0?void 0:cartItems.length)>0?/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(Hidden,{xsDown:true,children:/*#__PURE__*/_jsx(TableCell,{})}),/*#__PURE__*/_jsx(TableCell,{children:\"Name\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Price\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Qty\"}),/*#__PURE__*/_jsx(TableCell,{})]})}),/*#__PURE__*/_jsx(TableBody,{children:cartItems===null||cartItems===void 0?void 0:cartItems.map(function(_ref3){var id=_ref3.id,name=_ref3.name,price=_ref3.price,imageUrl=_ref3.imageUrl,countInStock=_ref3.countInStock,qty=_ref3.qty;return/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(Hidden,{xsDown:true,children:/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Paper,{className:classes.paper,elevation:0,children:/*#__PURE__*/_jsx(CardMedia,{className:classes.media,image:imageUrl||'/images/placeholder.jpg',title:name})})})}),/*#__PURE__*/_jsx(TableCell,{children:name}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(\"span\",{children:[\"\".concat(qty,\" x $\").concat(price,\" = \"),/*#__PURE__*/_jsx(\"strong\",{children:\"$\".concat(total.toFixed(2))})]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(FormControl,{variant:\"outlined\",children:/*#__PURE__*/_jsx(Select,{className:classes.select,native:true,onChange:function onChange(event){return addToCartHandler(id,Number(event.target.value));},value:qty,children:_toConsumableArray(Array(countInStock).keys()).map(function(num){return/*#__PURE__*/_jsx(\"option\",{value:num+1,children:num+1},num);})})})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Tooltip,{TransitionComponent:Zoom,title:\"Remove item\",children:/*#__PURE__*/_jsx(IconButton,{color:\"inherit\",size:\"small\",onClick:function onClick(){return removeFromCartHandler(id);},children:/*#__PURE__*/_jsx(DeleteIcon,{})})})})]},id);})})]})}):/*#__PURE__*/_jsx(AlertMessage,{message:\"Cart is empty\",severity:\"info\"})]})]}),/*#__PURE__*/_jsx(Grid,{item:true,md:3,sm:12,xs:12,children:/*#__PURE__*/_jsx(PlaceOrderSummary,{loading:cartLoading||shippingLoading||paymentLoading,total:total===null||total===void 0?void 0:total.toFixed(2),tax:tax===null||tax===void 0?void 0:tax.toFixed(2),shippingCost:shippingCost===null||shippingCost===void 0?void 0:shippingCost.toFixed(2),subTotal:subTotal===null||subTotal===void 0?void 0:subTotal.toFixed(2),disable:disableBtn,handleClick:handlePlaceOrder})})]});};export default PlaceOrder;","map":{"version":3,"sources":["/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/src/components/checkout/pages/PlaceOrder.js"],"names":["React","useState","useEffect","useCallback","useHistory","useDispatch","useSelector","PlaceOrderSummary","AlertMessage","LoadingLinear","PageHeading","SkeletonCartBody","SkeletonPrice","SkeletonProductDescription","addressStringify","paymentMethodStringify","addToCart","removeFromCart","placeOrder","makeStyles","Typography","Divider","Hidden","Grid","TableContainer","Table","TableHead","TableBody","TableRow","TableCell","Paper","CardMedia","IconButton","FormControl","Select","Tooltip","Zoom","DeleteIcon","useStyles","theme","root","margin","spacing","marginBottom","breakpoints","up","justifyContent","down","paper","width","height","media","subRoot","select","fontSize","display","PlaceOrder","classes","history","dispatch","newOrderId","setNewOrderId","state","userAuth","loggedInUser","user","token","cart","cartLoading","loading","cartError","error","cartItems","checkout","shippingLoading","shippingError","selectedshipping","paymentLoading","paymentError","selectedpayment","selShipping","setSelShipping","selPayment","setSelPayment","total","setTotal","tax","setTax","shippingCost","setShippingCost","subTotal","setSubTotal","disableBtn","setDisableBtn","SDKReady","setSDKReady","addToCartHandler","pid","qty","removeFromCartHandler","calculateTotal","reduce","acc","product","price","calculateTax","taxPercentage","calculateShippingCost","length","calculateSubTotal","onSuccess","handlePlaceOrder","paymentData","modifiedCartItems","map","item","newItem","productId","id","creatorId","name","imageUrl","rating","numReviews","reviewIds","countInStock","description","brand","category","paymentResult","payId","status","update_time","email_address","payer","amount","purchase_units","value","values","shippingAddressId","paymentMethodId","orderItems","buyer","isPaid","paidAt","Date","isDelivered","deliveredAt","addPaypalScript","fetch","process","env","REACT_APP_API_URL","headers","Authorization","res","json","clientId","script","document","createElement","src","type","async","body","append","onload","console","log","shipping","payment","push","toFixed","event","Number","target","Array","keys","num"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport PlaceOrderSummary from '../components/PlaceOrderSummary';\nimport AlertMessage from '../../shared/ui/AlertMessage';\nimport LoadingLinear from '../../shared/ui/LoadingLinear';\nimport PageHeading from '../../shared/ui/PageHeading';\nimport SkeletonCartBody from '../../shared/ui/skeletons/SkeletonCartBody';\nimport {\n  SkeletonPrice,\n  SkeletonProductDescription,\n} from '../../shared/ui/skeletons/SkeletonComponents';\nimport { addressStringify, paymentMethodStringify } from '../../../helpers';\n\nimport {\n  addToCart,\n  removeFromCart,\n} from '../../../redux/actionCreators/cartActionCreators';\n\nimport { placeOrder } from '../../../redux/actionCreators/orderActionCreators';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\nimport Hidden from '@material-ui/core/Hidden';\nimport Grid from '@material-ui/core/Grid';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport Table from '@material-ui/core/Table';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableRow from '@material-ui/core/TableRow';\nimport TableCell from '@material-ui/core/TableCell';\nimport Paper from '@material-ui/core/Paper';\nimport CardMedia from '@material-ui/core/CardMedia';\nimport IconButton from '@material-ui/core/IconButton';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Zoom from '@material-ui/core/Zoom';\n\nimport DeleteIcon from '@material-ui/icons/Delete';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    margin: theme.spacing(8, 0),\n    marginBottom: theme.spacing(15),\n    [theme.breakpoints.up('md')]: {\n      justifyContent: 'center',\n    },\n    [theme.breakpoints.down('lg')]: {\n      justifyContent: 'flex-end',\n    },\n  },\n  paper: {\n    width: theme.spacing(10),\n    height: theme.spacing(7),\n  },\n  media: {\n    width: '100%',\n    height: '100%',\n  },\n  subRoot: {\n    margin: theme.spacing(6, 0),\n  },\n  select: {\n    [theme.breakpoints.down('xs')]: {\n      width: theme.spacing(4),\n      height: theme.spacing(4),\n      fontSize: '13px',\n      '&>svg': {\n        display: 'none',\n      },\n    },\n  },\n}));\n\nconst PlaceOrder = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const [newOrderId, setNewOrderId] = useState(null);\n  const {\n    loggedInUser: { user, token },\n  } = useSelector((state) => state.userAuth);\n  const {\n    loading: cartLoading,\n    error: cartError,\n    cartItems,\n  } = useSelector((state) => state.cart);\n  const {\n    loading: shippingLoading,\n    shippingError,\n    selectedshipping,\n  } = useSelector((state) => state.checkout);\n  const {\n    loading: paymentLoading,\n    paymentError,\n    selectedpayment,\n  } = useSelector((state) => state.checkout);\n  const [selShipping, setSelShipping] = useState(null);\n  const [selPayment, setSelPayment] = useState(null);\n  const [total, setTotal] = useState(0);\n  const [tax, setTax] = useState(0);\n  const [shippingCost, setShippingCost] = useState(0);\n  const [subTotal, setSubTotal] = useState(0);\n  const [disableBtn, setDisableBtn] = useState(false);\n  const [SDKReady, setSDKReady] = useState(false);\n\n  const addToCartHandler = useCallback(\n    (pid, qty) => {\n      dispatch(addToCart(pid, qty));\n    },\n    [dispatch]\n  );\n  const removeFromCartHandler = (pid) => {\n    dispatch(removeFromCart(pid));\n  };\n  const calculateTotal = useCallback(() => {\n    const total = cartItems.reduce((acc, product) => {\n      return product.price * product.qty + acc;\n    }, 0);\n    setTotal(total);\n  }, [cartItems]);\n  const calculateTax = useCallback(() => {\n    let taxPercentage = 10;\n    const tax = total * (taxPercentage / 100.0);\n    setTax(tax);\n  }, [total]);\n  const calculateShippingCost = useCallback(() => {\n    switch (true) {\n      case cartItems.length <= 0:\n        setShippingCost(0);\n        break;\n      case cartItems.length > 20:\n        setShippingCost(0);\n        break;\n      case cartItems.length > 10 && cartItems.length <= 20:\n        setShippingCost(15);\n        break;\n      case cartItems.length < 10:\n        setShippingCost(25);\n        break;\n      default:\n        setShippingCost(0);\n        break;\n    }\n  }, [cartItems?.length]);\n  const calculateSubTotal = useCallback(() => {\n    const subTotal = total + tax + shippingCost;\n    setSubTotal(subTotal);\n  }, [shippingCost, tax, total]);\n\n  const onSuccess = (newOrderId) => {\n    if (newOrderId) {\n      setNewOrderId(newOrderId);\n    }\n  };\n  const handlePlaceOrder = (paymentData) => {\n    const modifiedCartItems = cartItems.map((item) => {\n      const newItem = { ...item, productId: item.id };\n      delete newItem.id;\n      delete newItem.creatorId;\n      delete newItem.name;\n      delete newItem.price;\n      delete newItem.imageUrl;\n      delete newItem.rating;\n      delete newItem.numReviews;\n      delete newItem.reviewIds;\n      delete newItem.countInStock;\n      delete newItem.description;\n      delete newItem.brand;\n      delete newItem.category;\n      return newItem;\n    });\n\n    const paymentResult = {\n      payId: paymentData.id,\n      status: paymentData.status,\n      update_time: paymentData.update_time,\n      email_address: paymentData.payer.email_address,\n      amount: paymentData.purchase_units[0].amount.value,\n    };\n\n    const values = {\n      shippingAddressId: selectedshipping.id,\n      paymentMethodId: selectedpayment.id,\n      orderItems: modifiedCartItems,\n      buyer: user,\n      paymentResult,\n      token,\n      tax,\n      shippingCost,\n      total,\n      subTotal,\n      isPaid: true,\n      paidAt: new Date(),\n      isDelivered: false,\n      deliveredAt: null,\n      onSuccess,\n    };\n    // console.log('values: ', values);\n    dispatch(placeOrder(values));\n  };\n\n  const addPaypalScript = useCallback(async () => {\n    let script;\n    try {\n      const res = await fetch(\n        `${process.env.REACT_APP_API_URL}/orders/paypalConfig`,\n        {\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      );\n      const { clientId } = await res.json();\n      script = document.createElement('script');\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}&currency=USD&disable-funding=credit,card&commit=true`;\n      script.type = 'text/javascript';\n      script.async = true;\n      document.body.append(script);\n      script.onload = () => setSDKReady(true);\n    } catch (error) {\n      console.log(error);\n    }\n  }, [token]);\n\n  useEffect(() => {\n    (async () => {\n      if (token) {\n        await addPaypalScript();\n      }\n    })();\n  }, [token, addPaypalScript]);\n\n  useEffect(() => {\n    if (\n      !token ||\n      !cartItems ||\n      !selectedshipping ||\n      !selectedpayment ||\n      (cartItems && cartItems.length <= 0)\n    ) {\n      setDisableBtn(true);\n    }\n  }, [token, cartItems, selectedshipping, selectedpayment]);\n\n  useEffect(() => {\n    if (selectedshipping) {\n      const shipping = addressStringify(selectedshipping);\n      setSelShipping(shipping);\n    }\n  }, [selectedshipping]);\n\n  useEffect(() => {\n    if (selectedpayment) {\n      const payment = paymentMethodStringify(selectedpayment);\n      setSelPayment(payment);\n    }\n  }, [selectedpayment]);\n\n  useEffect(() => {\n    calculateTotal();\n    calculateShippingCost();\n  }, [cartItems, calculateTotal, calculateShippingCost]);\n\n  useEffect(() => {\n    calculateTax();\n  }, [total, calculateTax]);\n\n  useEffect(() => {\n    calculateSubTotal();\n  }, [total, tax, shippingCost, calculateSubTotal]);\n\n  useEffect(() => {\n    if (newOrderId) {\n      history.push(`/orders/${newOrderId}`);\n    }\n  }, [newOrderId, history]);\n\n  if (!SDKReady) {\n    return <LoadingLinear />;\n  }\n\n  return (\n    <Grid container spacing={2} className={classes.root}>\n      <Grid item md={8} sm={12} xs={12}>\n        <div className={classes.subRoot}>\n          <PageHeading text=\"SHIPPING ADDRESS\" paragraph size=\"medium\" />\n          {shippingLoading && <SkeletonProductDescription />}\n          {shippingError && (\n            <AlertMessage\n              message={shippingError}\n              severity=\"error\"\n              variant=\"outlined\"\n            />\n          )}\n          <Typography paragraph gutterBottom>\n            {selShipping}\n          </Typography>\n          <Divider />\n        </div>\n        <div className={classes.subRoot}>\n          <PageHeading text=\"PAYMENT METHOD\" paragraph size=\"medium\" />\n          {paymentLoading && <SkeletonPrice />}\n          {paymentError && (\n            <AlertMessage\n              message={paymentError}\n              severity=\"error\"\n              variant=\"outlined\"\n            />\n          )}\n          <Typography paragraph gutterBottom>\n            {selPayment}\n          </Typography>\n          <Divider />\n        </div>\n        <div>\n          <PageHeading text=\"ORDER ITEMS\" paragraph size=\"medium\" />\n          {cartLoading && <SkeletonCartBody />}\n          {cartError && (\n            <AlertMessage\n              message={cartError}\n              severity=\"error\"\n              variant=\"outlined\"\n            />\n          )}\n          {cartItems?.length > 0 ? (\n            <TableContainer>\n              <Table>\n                <TableHead>\n                  <TableRow>\n                    <Hidden xsDown>\n                      <TableCell></TableCell>\n                    </Hidden>\n                    <TableCell>Name</TableCell>\n                    <TableCell>Price</TableCell>\n                    <TableCell>Qty</TableCell>\n                    <TableCell></TableCell>\n                  </TableRow>\n                </TableHead>\n                <TableBody>\n                  {cartItems?.map(\n                    ({ id, name, price, imageUrl, countInStock, qty }) => {\n                      return (\n                        <TableRow key={id}>\n                          <Hidden xsDown>\n                            <TableCell>\n                              <Paper className={classes.paper} elevation={0}>\n                                <CardMedia\n                                  className={classes.media}\n                                  image={imageUrl || '/images/placeholder.jpg'}\n                                  title={name}\n                                />\n                              </Paper>\n                            </TableCell>\n                          </Hidden>\n                          <TableCell>{name}</TableCell>\n                          <TableCell>\n                            <span>\n                              {`${qty} x $${price} = `}\n                              <strong>{`$${total.toFixed(2)}`}</strong>\n                            </span>\n                          </TableCell>\n                          <TableCell>\n                            <FormControl variant=\"outlined\">\n                              <Select\n                                className={classes.select}\n                                native\n                                onChange={(event) =>\n                                  addToCartHandler(\n                                    id,\n                                    Number(event.target.value)\n                                  )\n                                }\n                                value={qty}\n                              >\n                                {[...Array(countInStock).keys()].map((num) => (\n                                  <option key={num} value={num + 1}>\n                                    {num + 1}\n                                  </option>\n                                ))}\n                              </Select>\n                            </FormControl>\n                          </TableCell>\n                          <TableCell>\n                            <Tooltip\n                              TransitionComponent={Zoom}\n                              title=\"Remove item\"\n                            >\n                              <IconButton\n                                color=\"inherit\"\n                                size=\"small\"\n                                onClick={() => removeFromCartHandler(id)}\n                              >\n                                <DeleteIcon />\n                              </IconButton>\n                            </Tooltip>\n                          </TableCell>\n                        </TableRow>\n                      );\n                    }\n                  )}\n                </TableBody>\n              </Table>\n            </TableContainer>\n          ) : (\n            <AlertMessage message=\"Cart is empty\" severity=\"info\" />\n          )}\n        </div>\n      </Grid>\n      <Grid item md={3} sm={12} xs={12}>\n        <PlaceOrderSummary\n          loading={cartLoading || shippingLoading || paymentLoading}\n          total={total?.toFixed(2)}\n          tax={tax?.toFixed(2)}\n          shippingCost={shippingCost?.toFixed(2)}\n          subTotal={subTotal?.toFixed(2)}\n          disable={disableBtn}\n          handleClick={handlePlaceOrder}\n        />\n      </Grid>\n    </Grid>\n  );\n};\n\nexport default PlaceOrder;\n"]},"metadata":{},"sourceType":"module"}