{"ast":null,"code":"import _slicedToArray from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useDispatch,useSelector}from'react-redux';import UserList from'../components/UserList.js';import UserUpdateModalForm from'../components/UserUpdateModalForm.js';import ListSearchBar from'../components/ListSearchBar';import SkeletonHistory from'../../shared/ui/skeletons/SkeletonHistory';import{listUsers,deleteUser,updateUserByAdmin}from'../../../redux/actionCreators/userActionCreators.js';import PageHeading from'../../shared/ui/PageHeading.js';import AlertMessage from'../../shared/ui/AlertMessage.js';import DecisionDialog from'../../shared/ui/DecisionDialog.js';import{makeStyles}from'@material-ui/core/styles';import IconButton from'@material-ui/core/IconButton';import Tooltip from'@material-ui/core/Tooltip';import Zoom from'@material-ui/core/Zoom';import Toast from'../../shared/ui/Toast';import RefreshIcon from'@material-ui/icons/RefreshSharp';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{topBtns:{display:'flex',width:'100%',marginBottom:'10px',justifyContent:'space-between',alignItems:'center'}};});var AllUsers=function AllUsers(){var _loggedInUser$user;var classes=useStyles();var dispatch=useDispatch();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),openToast=_useState2[0],setOpenToast=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),operation=_useState4[0],setOperation=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),modalOpen=_useState6[0],setModalOpen=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),userToUpdate=_useState8[0],setUserToUpdate=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),userToDelete=_useState10[0],setUserToDelete=_useState10[1];var _useSelector=useSelector(function(state){return state.userList||{};}),loading=_useSelector.loading,error=_useSelector.error,userInfo=_useSelector.userInfo;var _useSelector2=useSelector(function(state){return state.userAuth;}),loggedInUser=_useSelector2.loggedInUser;var onSuccess=function onSuccess(){setOpenToast(true);dispatch(listUsers(loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token));if(modalOpen===true){setModalOpen(false);}};var handleOperation=function handleOperation(operation,userToHandle){if(operation==='delete'){setUserToDelete(userToHandle);setModalOpen(true);setOperation('delete');}else if(operation==='update'){setUserToUpdate(userToHandle);setModalOpen(true);setOperation('update');}};var handleDeleteSubmit=function handleDeleteSubmit(){dispatch(deleteUser(userToDelete.id,loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token,onSuccess));};var handleUpdateSubmit=function handleUpdateSubmit(userInfo){dispatch(updateUserByAdmin(userToUpdate.id,loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token,userInfo,onSuccess));};var handlePageChange=function handlePageChange(page,perPage){dispatch(listUsers(loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token,'',page,perPage));};var handlePerPageChange=function handlePerPageChange(perPage){dispatch(listUsers(loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token,'','',perPage));};useEffect(function(){if(loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token){dispatch(listUsers(loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token));}},[dispatch,loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(PageHeading,{text:\"ALL USERS\",gutterBottom:true}),/*#__PURE__*/_jsx(DecisionDialog,{open:modalOpen,setDialogOpen:setModalOpen,title:operation==='update'?'Change User Details':'Delete User',content:operation==='delete'?\"Are you sure you wish to delete user \".concat(userToDelete.name):'',actionBtnText:operation==='delete'?'DELETE':null,handleAction:operation==='delete'?handleDeleteSubmit:null,children:operation==='update'&&userToUpdate&&/*#__PURE__*/_jsx(UserUpdateModalForm,{userToUpdate:userToUpdate,handleUpdate:handleUpdateSubmit})}),/*#__PURE__*/_jsx(Toast,{openToast:openToast,setOpenToast:setOpenToast,severity:\"success\",message:operation==='delete'?'User deleted!':'User details updated!'}),/*#__PURE__*/_jsxs(\"div\",{className:classes.topBtns,children:[/*#__PURE__*/_jsx(ListSearchBar,{item:\"user\",args:[loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token]}),/*#__PURE__*/_jsx(Tooltip,{TransitionComponent:Zoom,title:\"Refresh\",children:/*#__PURE__*/_jsx(IconButton,{className:classes.iconBtn,color:\"primary\",onClick:function onClick(){return dispatch(listUsers(loggedInUser===null||loggedInUser===void 0?void 0:loggedInUser.token));},style:{marginTop:'20px'},children:/*#__PURE__*/_jsx(RefreshIcon,{})})})]}),loading&&/*#__PURE__*/_jsx(SkeletonHistory,{headings:['ID','NAME','EMAIL','ADMIN','']}),error&&/*#__PURE__*/_jsx(AlertMessage,{message:error,severity:\"error\",variant:\"outlined\"}),!loading&&(userInfo===null||userInfo===void 0?void 0:userInfo.users)&&/*#__PURE__*/_jsx(UserList,{userInfo:userInfo,handleOperation:handleOperation,loggedInUserId:loggedInUser===null||loggedInUser===void 0?void 0:(_loggedInUser$user=loggedInUser.user)===null||_loggedInUser$user===void 0?void 0:_loggedInUser$user.id,handlePageChange:handlePageChange,handlePerPageChange:handlePerPageChange})]});};export default AllUsers;","map":{"version":3,"sources":["/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/src/components/users/pages/AllUsers.js"],"names":["React","useEffect","useState","useDispatch","useSelector","UserList","UserUpdateModalForm","ListSearchBar","SkeletonHistory","listUsers","deleteUser","updateUserByAdmin","PageHeading","AlertMessage","DecisionDialog","makeStyles","IconButton","Tooltip","Zoom","Toast","RefreshIcon","useStyles","theme","topBtns","display","width","marginBottom","justifyContent","alignItems","AllUsers","classes","dispatch","openToast","setOpenToast","operation","setOperation","modalOpen","setModalOpen","userToUpdate","setUserToUpdate","userToDelete","setUserToDelete","state","userList","loading","error","userInfo","userAuth","loggedInUser","onSuccess","token","handleOperation","userToHandle","handleDeleteSubmit","id","handleUpdateSubmit","handlePageChange","page","perPage","handlePerPageChange","name","iconBtn","marginTop","users","user"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport UserList from '../components/UserList.js';\nimport UserUpdateModalForm from '../components/UserUpdateModalForm.js';\nimport ListSearchBar from '../components/ListSearchBar';\nimport SkeletonHistory from '../../shared/ui/skeletons/SkeletonHistory';\n\nimport {\n  listUsers,\n  deleteUser,\n  updateUserByAdmin,\n} from '../../../redux/actionCreators/userActionCreators.js';\n\nimport PageHeading from '../../shared/ui/PageHeading.js';\nimport AlertMessage from '../../shared/ui/AlertMessage.js';\nimport DecisionDialog from '../../shared/ui/DecisionDialog.js';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Zoom from '@material-ui/core/Zoom';\nimport Toast from '../../shared/ui/Toast';\n\nimport RefreshIcon from '@material-ui/icons/RefreshSharp';\n\nconst useStyles = makeStyles((theme) => ({\n  topBtns: {\n    display: 'flex',\n    width: '100%',\n    marginBottom: '10px',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n  },\n}));\n\nconst AllUsers = () => {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const [openToast, setOpenToast] = useState(false);\n  const [operation, setOperation] = useState();\n  const [modalOpen, setModalOpen] = useState(false);\n  const [userToUpdate, setUserToUpdate] = useState();\n  const [userToDelete, setUserToDelete] = useState();\n  const { loading, error, userInfo } = useSelector(\n    (state) => state.userList || {}\n  );\n  const { loggedInUser } = useSelector((state) => state.userAuth);\n  const onSuccess = () => {\n    setOpenToast(true);\n    dispatch(listUsers(loggedInUser?.token));\n    if (modalOpen === true) {\n      setModalOpen(false);\n    }\n  };\n  const handleOperation = (operation, userToHandle) => {\n    if (operation === 'delete') {\n      setUserToDelete(userToHandle);\n      setModalOpen(true);\n      setOperation('delete');\n    } else if (operation === 'update') {\n      setUserToUpdate(userToHandle);\n      setModalOpen(true);\n      setOperation('update');\n    }\n  };\n  const handleDeleteSubmit = () => {\n    dispatch(deleteUser(userToDelete.id, loggedInUser?.token, onSuccess));\n  };\n  const handleUpdateSubmit = (userInfo) => {\n    dispatch(\n      updateUserByAdmin(\n        userToUpdate.id,\n        loggedInUser?.token,\n        userInfo,\n        onSuccess\n      )\n    );\n  };\n  const handlePageChange = (page, perPage) => {\n    dispatch(listUsers(loggedInUser?.token, '', page, perPage));\n  };\n  const handlePerPageChange = (perPage) => {\n    dispatch(listUsers(loggedInUser?.token, '', '', perPage));\n  };\n  useEffect(() => {\n    if (loggedInUser?.token) {\n      dispatch(listUsers(loggedInUser?.token));\n    }\n  }, [dispatch, loggedInUser?.token]);\n\n  return (\n    <>\n      <PageHeading text=\"ALL USERS\" gutterBottom />\n      <DecisionDialog\n        open={modalOpen}\n        setDialogOpen={setModalOpen}\n        title={operation === 'update' ? 'Change User Details' : 'Delete User'}\n        content={\n          operation === 'delete'\n            ? `Are you sure you wish to delete user ${userToDelete.name}`\n            : ''\n        }\n        actionBtnText={operation === 'delete' ? 'DELETE' : null}\n        handleAction={operation === 'delete' ? handleDeleteSubmit : null}\n      >\n        {operation === 'update' && userToUpdate && (\n          <UserUpdateModalForm\n            userToUpdate={userToUpdate}\n            handleUpdate={handleUpdateSubmit}\n          />\n        )}\n      </DecisionDialog>\n      <Toast\n        openToast={openToast}\n        setOpenToast={setOpenToast}\n        severity=\"success\"\n        message={\n          operation === 'delete' ? 'User deleted!' : 'User details updated!'\n        }\n      />\n      <div className={classes.topBtns}>\n        <ListSearchBar item=\"user\" args={[loggedInUser?.token]} />\n        <Tooltip TransitionComponent={Zoom} title=\"Refresh\">\n          <IconButton\n            className={classes.iconBtn}\n            color=\"primary\"\n            onClick={() => dispatch(listUsers(loggedInUser?.token))}\n            style={{ marginTop: '20px' }}\n          >\n            <RefreshIcon />\n          </IconButton>\n        </Tooltip>\n      </div>\n      {loading && (\n        <SkeletonHistory headings={['ID', 'NAME', 'EMAIL', 'ADMIN', '']} />\n      )}\n      {error && (\n        <AlertMessage message={error} severity=\"error\" variant=\"outlined\" />\n      )}\n      {!loading && userInfo?.users && (\n        <UserList\n          userInfo={userInfo}\n          handleOperation={handleOperation}\n          loggedInUserId={loggedInUser?.user?.id}\n          handlePageChange={handlePageChange}\n          handlePerPageChange={handlePerPageChange}\n        />\n      )}\n    </>\n  );\n};\n\nexport default AllUsers;\n"]},"metadata":{},"sourceType":"module"}