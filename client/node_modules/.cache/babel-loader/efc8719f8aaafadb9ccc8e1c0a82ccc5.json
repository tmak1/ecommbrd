{"ast":null,"code":"var _jsxFileName = \"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/src/components/checkout/pages/PlaceOrder.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\nimport PlaceOrderSummary from '../components/PlaceOrderSummary';\nimport AlertMessage from '../../shared/ui/AlertMessage';\nimport LoadingLinear from '../../shared/ui/LoadingLinear';\nimport PageHeading from '../../shared/ui/PageHeading';\nimport SkeletonCartBody from '../../shared/ui/skeletons/SkeletonCartBody';\nimport { SkeletonPrice, SkeletonProductDescription } from '../../shared/ui/skeletons/SkeletonComponents';\nimport { addressStringify, paymentMethodStringify } from '../../../helpers';\nimport { addToCart, removeFromCart } from '../../../redux/actionCreators/cartActionCreators';\nimport { placeOrder } from '../../../redux/actionCreators/orderActionCreators';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\nimport Hidden from '@material-ui/core/Hidden';\nimport Grid from '@material-ui/core/Grid';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport Table from '@material-ui/core/Table';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableRow from '@material-ui/core/TableRow';\nimport TableCell from '@material-ui/core/TableCell';\nimport Paper from '@material-ui/core/Paper';\nimport CardMedia from '@material-ui/core/CardMedia';\nimport IconButton from '@material-ui/core/IconButton';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Zoom from '@material-ui/core/Zoom';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  root: {\n    margin: theme.spacing(8, 0),\n    marginBottom: theme.spacing(15),\n    [theme.breakpoints.up('md')]: {\n      justifyContent: 'center'\n    },\n    [theme.breakpoints.down('lg')]: {\n      justifyContent: 'flex-end'\n    }\n  },\n  paper: {\n    width: theme.spacing(10),\n    height: theme.spacing(7)\n  },\n  media: {\n    width: '100%',\n    height: '100%'\n  },\n  subRoot: {\n    margin: theme.spacing(6, 0)\n  },\n  select: {\n    [theme.breakpoints.down('xs')]: {\n      width: theme.spacing(4),\n      height: theme.spacing(4),\n      fontSize: '13px',\n      '&>svg': {\n        display: 'none'\n      }\n    }\n  }\n}));\n\nconst PlaceOrder = () => {\n  _s();\n\n  const classes = useStyles();\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const [newOrderId, setNewOrderId] = useState(null);\n  const {\n    loggedInUser: {\n      user,\n      token\n    }\n  } = useSelector(state => state.userAuth);\n  const {\n    loading: cartLoading,\n    error: cartError,\n    cartItems\n  } = useSelector(state => state.cart);\n  const {\n    loading: shippingLoading,\n    shippingError,\n    selectedshipping\n  } = useSelector(state => state.checkout);\n  const {\n    loading: paymentLoading,\n    paymentError,\n    selectedpayment\n  } = useSelector(state => state.checkout);\n  const [selShipping, setSelShipping] = useState(null);\n  const [selPayment, setSelPayment] = useState(null);\n  const [total, setTotal] = useState(0);\n  const [tax, setTax] = useState(0);\n  const [shippingCost, setShippingCost] = useState(0);\n  const [subTotal, setSubTotal] = useState(0);\n  const [disableBtn, setDisableBtn] = useState(false);\n  const [SDKReady, setSDKReady] = useState(false);\n  const addToCartHandler = useCallback((pid, qty) => {\n    dispatch(addToCart(pid, qty));\n  }, [dispatch]);\n\n  const removeFromCartHandler = pid => {\n    dispatch(removeFromCart(pid));\n  };\n\n  const calculateTotal = useCallback(() => {\n    const total = cartItems.reduce((acc, product) => {\n      return product.price * product.qty + acc;\n    }, 0);\n    setTotal(total);\n  }, [cartItems]);\n  const calculateTax = useCallback(() => {\n    let taxPercentage = 10;\n    const tax = total * (taxPercentage / 100.0);\n    setTax(tax);\n  }, [total]);\n  const calculateShippingCost = useCallback(() => {\n    switch (true) {\n      case cartItems.length <= 0:\n        setShippingCost(0);\n        break;\n\n      case cartItems.length > 20:\n        setShippingCost(0);\n        break;\n\n      case cartItems.length > 10 && cartItems.length <= 20:\n        setShippingCost(15);\n        break;\n\n      case cartItems.length < 10:\n        setShippingCost(25);\n        break;\n\n      default:\n        setShippingCost(0);\n        break;\n    }\n  }, [cartItems === null || cartItems === void 0 ? void 0 : cartItems.length]);\n  const calculateSubTotal = useCallback(() => {\n    const subTotal = total + tax + shippingCost;\n    setSubTotal(subTotal);\n  }, [shippingCost, tax, total]);\n\n  const onSuccess = newOrderId => {\n    if (newOrderId) {\n      setNewOrderId(newOrderId);\n    }\n  };\n\n  const handlePlaceOrder = paymentData => {\n    const modifiedCartItems = cartItems.map(item => {\n      const newItem = { ...item,\n        productId: item.id\n      };\n      delete newItem.id;\n      delete newItem.creatorId;\n      delete newItem.name;\n      delete newItem.price;\n      delete newItem.imageUrl;\n      delete newItem.rating;\n      delete newItem.numReviews;\n      delete newItem.reviewIds;\n      delete newItem.countInStock;\n      delete newItem.description;\n      delete newItem.brand;\n      delete newItem.category;\n      return newItem;\n    });\n    const paymentResult = {\n      payId: paymentData.id,\n      status: paymentData.status,\n      update_time: paymentData.update_time,\n      email_address: paymentData.payer.email_address,\n      amount: paymentData.purchase_units[0].amount.value\n    };\n    const values = {\n      shippingAddressId: selectedshipping.id,\n      paymentMethodId: selectedpayment.id,\n      orderItems: modifiedCartItems,\n      buyer: user,\n      paymentResult,\n      token,\n      tax,\n      shippingCost,\n      total,\n      subTotal,\n      isPaid: true,\n      paidAt: new Date(),\n      isDelivered: false,\n      deliveredAt: null,\n      onSuccess\n    }; // console.log('values: ', values);\n\n    dispatch(placeOrder(values));\n  };\n\n  const addPaypalScript = useCallback(async () => {\n    let script;\n\n    try {\n      const res = await fetch(`${process.env.REACT_APP_API_URL}/orders/paypalConfig`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const {\n        clientId\n      } = await res.json();\n      script = document.createElement('script');\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}&currency=USD&disable-funding=credit,card&commit=true`;\n      script.type = 'text/javascript';\n      script.async = true;\n      document.body.append(script);\n\n      script.onload = () => setSDKReady(true);\n    } catch (error) {\n      console.log(error);\n    }\n  }, [token]);\n  useEffect(() => {\n    (async () => {\n      if (token) {\n        await addPaypalScript();\n      }\n    })();\n  }, [token, addPaypalScript]);\n  useEffect(() => {\n    if (!token || !cartItems || !selectedshipping || !selectedpayment || cartItems && cartItems.length <= 0) {\n      setDisableBtn(true);\n    }\n  }, [token, cartItems, selectedshipping, selectedpayment]);\n  useEffect(() => {\n    if (selectedshipping) {\n      const shipping = addressStringify(selectedshipping);\n      setSelShipping(shipping);\n    }\n  }, [selectedshipping]);\n  useEffect(() => {\n    if (selectedpayment) {\n      const payment = paymentMethodStringify(selectedpayment);\n      setSelPayment(payment);\n    }\n  }, [selectedpayment]);\n  useEffect(() => {\n    calculateTotal();\n    calculateShippingCost();\n  }, [cartItems, calculateTotal, calculateShippingCost]);\n  useEffect(() => {\n    calculateTax();\n  }, [total, calculateTax]);\n  useEffect(() => {\n    calculateSubTotal();\n  }, [total, tax, shippingCost, calculateSubTotal]);\n  useEffect(() => {\n    if (newOrderId) {\n      history.push(`/orders/${newOrderId}`);\n    }\n  }, [newOrderId, history]);\n\n  if (!SDKReady) {\n    return /*#__PURE__*/_jsxDEV(LoadingLinear, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 281,\n      columnNumber: 12\n    }, this);\n  }\n\n  return /*#__PURE__*/_jsxDEV(Grid, {\n    container: true,\n    spacing: 2,\n    className: classes.root,\n    children: [/*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      md: 8,\n      sm: 12,\n      xs: 12,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.subRoot,\n        children: [/*#__PURE__*/_jsxDEV(PageHeading, {\n          text: \"SHIPPING ADDRESS\",\n          paragraph: true,\n          size: \"medium\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 11\n        }, this), shippingLoading && /*#__PURE__*/_jsxDEV(SkeletonProductDescription, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 31\n        }, this), shippingError && /*#__PURE__*/_jsxDEV(AlertMessage, {\n          message: shippingError,\n          severity: \"error\",\n          variant: \"outlined\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          paragraph: true,\n          gutterBottom: true,\n          children: selShipping\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 300,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.subRoot,\n        children: [/*#__PURE__*/_jsxDEV(PageHeading, {\n          text: \"PAYMENT METHOD\",\n          paragraph: true,\n          size: \"medium\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }, this), paymentLoading && /*#__PURE__*/_jsxDEV(SkeletonPrice, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 304,\n          columnNumber: 30\n        }, this), paymentError && /*#__PURE__*/_jsxDEV(AlertMessage, {\n          message: paymentError,\n          severity: \"error\",\n          variant: \"outlined\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          paragraph: true,\n          gutterBottom: true,\n          children: selPayment\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 312,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Divider, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(PageHeading, {\n          text: \"ORDER ITEMS\",\n          paragraph: true,\n          size: \"medium\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 11\n        }, this), cartLoading && /*#__PURE__*/_jsxDEV(SkeletonCartBody, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 319,\n          columnNumber: 27\n        }, this), cartError && /*#__PURE__*/_jsxDEV(AlertMessage, {\n          message: cartError,\n          severity: \"error\",\n          variant: \"outlined\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 321,\n          columnNumber: 13\n        }, this), (cartItems === null || cartItems === void 0 ? void 0 : cartItems.length) > 0 ? /*#__PURE__*/_jsxDEV(TableContainer, {\n          children: /*#__PURE__*/_jsxDEV(Table, {\n            children: [/*#__PURE__*/_jsxDEV(TableHead, {\n              children: /*#__PURE__*/_jsxDEV(TableRow, {\n                children: [/*#__PURE__*/_jsxDEV(Hidden, {\n                  xsDown: true,\n                  children: /*#__PURE__*/_jsxDEV(TableCell, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 333,\n                    columnNumber: 23\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 332,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: \"Name\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 335,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: \"Price\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 336,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                  children: \"Qty\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 337,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(TableCell, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 338,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 331,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 330,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(TableBody, {\n              children: cartItems === null || cartItems === void 0 ? void 0 : cartItems.map(({\n                id,\n                name,\n                price,\n                imageUrl,\n                countInStock,\n                qty\n              }) => {\n                return /*#__PURE__*/_jsxDEV(TableRow, {\n                  children: [/*#__PURE__*/_jsxDEV(Hidden, {\n                    xsDown: true,\n                    children: /*#__PURE__*/_jsxDEV(TableCell, {\n                      children: /*#__PURE__*/_jsxDEV(Paper, {\n                        className: classes.paper,\n                        elevation: 0,\n                        children: /*#__PURE__*/_jsxDEV(CardMedia, {\n                          className: classes.media,\n                          image: imageUrl || '/images/placeholder.jpg',\n                          title: name\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 349,\n                          columnNumber: 33\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 348,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 347,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 346,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                    children: name\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 357,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: [`${qty} x $${price} = `, /*#__PURE__*/_jsxDEV(\"strong\", {\n                        children: `$${total.toFixed(2)}`\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 361,\n                        columnNumber: 31\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 359,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 358,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                    children: /*#__PURE__*/_jsxDEV(FormControl, {\n                      variant: \"outlined\",\n                      children: /*#__PURE__*/_jsxDEV(Select, {\n                        className: classes.select,\n                        native: true,\n                        onChange: event => addToCartHandler(id, Number(event.target.value)),\n                        value: qty,\n                        children: [...Array(countInStock).keys()].map(num => /*#__PURE__*/_jsxDEV(\"option\", {\n                          value: num + 1,\n                          children: num + 1\n                        }, num, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 378,\n                          columnNumber: 35\n                        }, this))\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 366,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 365,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 364,\n                    columnNumber: 27\n                  }, this), /*#__PURE__*/_jsxDEV(TableCell, {\n                    children: /*#__PURE__*/_jsxDEV(Tooltip, {\n                      TransitionComponent: Zoom,\n                      title: \"Remove item\",\n                      children: /*#__PURE__*/_jsxDEV(IconButton, {\n                        color: \"inherit\",\n                        size: \"small\",\n                        onClick: () => removeFromCartHandler(id),\n                        children: /*#__PURE__*/_jsxDEV(DeleteIcon, {}, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 395,\n                          columnNumber: 33\n                        }, this)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 390,\n                        columnNumber: 31\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 386,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 385,\n                    columnNumber: 27\n                  }, this)]\n                }, id, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 345,\n                  columnNumber: 25\n                }, this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 341,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 13\n        }, this) : /*#__PURE__*/_jsxDEV(AlertMessage, {\n          message: \"Cart is empty\",\n          severity: \"info\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 317,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      item: true,\n      md: 3,\n      sm: 12,\n      xs: 12,\n      children: /*#__PURE__*/_jsxDEV(PlaceOrderSummary, {\n        loading: cartLoading || shippingLoading || paymentLoading,\n        total: total === null || total === void 0 ? void 0 : total.toFixed(2),\n        tax: tax === null || tax === void 0 ? void 0 : tax.toFixed(2),\n        shippingCost: shippingCost === null || shippingCost === void 0 ? void 0 : shippingCost.toFixed(2),\n        subTotal: subTotal === null || subTotal === void 0 ? void 0 : subTotal.toFixed(2),\n        disable: disableBtn,\n        handleClick: handlePlaceOrder\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 412,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 411,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 285,\n    columnNumber: 5\n  }, this);\n};\n\n_s(PlaceOrder, \"y1pDCf4ezVQhb1peMXIr+aRAwKk=\", false, function () {\n  return [useStyles, useHistory, useDispatch, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = PlaceOrder;\nexport default PlaceOrder;\n\nvar _c;\n\n$RefreshReg$(_c, \"PlaceOrder\");","map":{"version":3,"sources":["/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/src/components/checkout/pages/PlaceOrder.js"],"names":["React","useState","useEffect","useCallback","useHistory","useDispatch","useSelector","PlaceOrderSummary","AlertMessage","LoadingLinear","PageHeading","SkeletonCartBody","SkeletonPrice","SkeletonProductDescription","addressStringify","paymentMethodStringify","addToCart","removeFromCart","placeOrder","makeStyles","Typography","Divider","Hidden","Grid","TableContainer","Table","TableHead","TableBody","TableRow","TableCell","Paper","CardMedia","IconButton","FormControl","Select","Tooltip","Zoom","DeleteIcon","useStyles","theme","root","margin","spacing","marginBottom","breakpoints","up","justifyContent","down","paper","width","height","media","subRoot","select","fontSize","display","PlaceOrder","classes","history","dispatch","newOrderId","setNewOrderId","loggedInUser","user","token","state","userAuth","loading","cartLoading","error","cartError","cartItems","cart","shippingLoading","shippingError","selectedshipping","checkout","paymentLoading","paymentError","selectedpayment","selShipping","setSelShipping","selPayment","setSelPayment","total","setTotal","tax","setTax","shippingCost","setShippingCost","subTotal","setSubTotal","disableBtn","setDisableBtn","SDKReady","setSDKReady","addToCartHandler","pid","qty","removeFromCartHandler","calculateTotal","reduce","acc","product","price","calculateTax","taxPercentage","calculateShippingCost","length","calculateSubTotal","onSuccess","handlePlaceOrder","paymentData","modifiedCartItems","map","item","newItem","productId","id","creatorId","name","imageUrl","rating","numReviews","reviewIds","countInStock","description","brand","category","paymentResult","payId","status","update_time","email_address","payer","amount","purchase_units","value","values","shippingAddressId","paymentMethodId","orderItems","buyer","isPaid","paidAt","Date","isDelivered","deliveredAt","addPaypalScript","script","res","fetch","process","env","REACT_APP_API_URL","headers","Authorization","clientId","json","document","createElement","src","type","async","body","append","onload","console","log","shipping","payment","push","toFixed","event","Number","target","Array","keys","num"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport PlaceOrderSummary from '../components/PlaceOrderSummary';\nimport AlertMessage from '../../shared/ui/AlertMessage';\nimport LoadingLinear from '../../shared/ui/LoadingLinear';\nimport PageHeading from '../../shared/ui/PageHeading';\nimport SkeletonCartBody from '../../shared/ui/skeletons/SkeletonCartBody';\nimport {\n  SkeletonPrice,\n  SkeletonProductDescription,\n} from '../../shared/ui/skeletons/SkeletonComponents';\nimport { addressStringify, paymentMethodStringify } from '../../../helpers';\n\nimport {\n  addToCart,\n  removeFromCart,\n} from '../../../redux/actionCreators/cartActionCreators';\n\nimport { placeOrder } from '../../../redux/actionCreators/orderActionCreators';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\nimport Hidden from '@material-ui/core/Hidden';\nimport Grid from '@material-ui/core/Grid';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport Table from '@material-ui/core/Table';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableRow from '@material-ui/core/TableRow';\nimport TableCell from '@material-ui/core/TableCell';\nimport Paper from '@material-ui/core/Paper';\nimport CardMedia from '@material-ui/core/CardMedia';\nimport IconButton from '@material-ui/core/IconButton';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Zoom from '@material-ui/core/Zoom';\n\nimport DeleteIcon from '@material-ui/icons/Delete';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    margin: theme.spacing(8, 0),\n    marginBottom: theme.spacing(15),\n    [theme.breakpoints.up('md')]: {\n      justifyContent: 'center',\n    },\n    [theme.breakpoints.down('lg')]: {\n      justifyContent: 'flex-end',\n    },\n  },\n  paper: {\n    width: theme.spacing(10),\n    height: theme.spacing(7),\n  },\n  media: {\n    width: '100%',\n    height: '100%',\n  },\n  subRoot: {\n    margin: theme.spacing(6, 0),\n  },\n  select: {\n    [theme.breakpoints.down('xs')]: {\n      width: theme.spacing(4),\n      height: theme.spacing(4),\n      fontSize: '13px',\n      '&>svg': {\n        display: 'none',\n      },\n    },\n  },\n}));\n\nconst PlaceOrder = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const dispatch = useDispatch();\n  const [newOrderId, setNewOrderId] = useState(null);\n  const {\n    loggedInUser: { user, token },\n  } = useSelector((state) => state.userAuth);\n  const {\n    loading: cartLoading,\n    error: cartError,\n    cartItems,\n  } = useSelector((state) => state.cart);\n  const {\n    loading: shippingLoading,\n    shippingError,\n    selectedshipping,\n  } = useSelector((state) => state.checkout);\n  const {\n    loading: paymentLoading,\n    paymentError,\n    selectedpayment,\n  } = useSelector((state) => state.checkout);\n  const [selShipping, setSelShipping] = useState(null);\n  const [selPayment, setSelPayment] = useState(null);\n  const [total, setTotal] = useState(0);\n  const [tax, setTax] = useState(0);\n  const [shippingCost, setShippingCost] = useState(0);\n  const [subTotal, setSubTotal] = useState(0);\n  const [disableBtn, setDisableBtn] = useState(false);\n  const [SDKReady, setSDKReady] = useState(false);\n\n  const addToCartHandler = useCallback(\n    (pid, qty) => {\n      dispatch(addToCart(pid, qty));\n    },\n    [dispatch]\n  );\n  const removeFromCartHandler = (pid) => {\n    dispatch(removeFromCart(pid));\n  };\n  const calculateTotal = useCallback(() => {\n    const total = cartItems.reduce((acc, product) => {\n      return product.price * product.qty + acc;\n    }, 0);\n    setTotal(total);\n  }, [cartItems]);\n  const calculateTax = useCallback(() => {\n    let taxPercentage = 10;\n    const tax = total * (taxPercentage / 100.0);\n    setTax(tax);\n  }, [total]);\n  const calculateShippingCost = useCallback(() => {\n    switch (true) {\n      case cartItems.length <= 0:\n        setShippingCost(0);\n        break;\n      case cartItems.length > 20:\n        setShippingCost(0);\n        break;\n      case cartItems.length > 10 && cartItems.length <= 20:\n        setShippingCost(15);\n        break;\n      case cartItems.length < 10:\n        setShippingCost(25);\n        break;\n      default:\n        setShippingCost(0);\n        break;\n    }\n  }, [cartItems?.length]);\n  const calculateSubTotal = useCallback(() => {\n    const subTotal = total + tax + shippingCost;\n    setSubTotal(subTotal);\n  }, [shippingCost, tax, total]);\n\n  const onSuccess = (newOrderId) => {\n    if (newOrderId) {\n      setNewOrderId(newOrderId);\n    }\n  };\n  const handlePlaceOrder = (paymentData) => {\n    const modifiedCartItems = cartItems.map((item) => {\n      const newItem = { ...item, productId: item.id };\n      delete newItem.id;\n      delete newItem.creatorId;\n      delete newItem.name;\n      delete newItem.price;\n      delete newItem.imageUrl;\n      delete newItem.rating;\n      delete newItem.numReviews;\n      delete newItem.reviewIds;\n      delete newItem.countInStock;\n      delete newItem.description;\n      delete newItem.brand;\n      delete newItem.category;\n      return newItem;\n    });\n\n    const paymentResult = {\n      payId: paymentData.id,\n      status: paymentData.status,\n      update_time: paymentData.update_time,\n      email_address: paymentData.payer.email_address,\n      amount: paymentData.purchase_units[0].amount.value,\n    };\n\n    const values = {\n      shippingAddressId: selectedshipping.id,\n      paymentMethodId: selectedpayment.id,\n      orderItems: modifiedCartItems,\n      buyer: user,\n      paymentResult,\n      token,\n      tax,\n      shippingCost,\n      total,\n      subTotal,\n      isPaid: true,\n      paidAt: new Date(),\n      isDelivered: false,\n      deliveredAt: null,\n      onSuccess,\n    };\n    // console.log('values: ', values);\n    dispatch(placeOrder(values));\n  };\n\n  const addPaypalScript = useCallback(async () => {\n    let script;\n    try {\n      const res = await fetch(\n        `${process.env.REACT_APP_API_URL}/orders/paypalConfig`,\n        {\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      );\n      const { clientId } = await res.json();\n      script = document.createElement('script');\n      script.src = `https://www.paypal.com/sdk/js?client-id=${clientId}&currency=USD&disable-funding=credit,card&commit=true`;\n      script.type = 'text/javascript';\n      script.async = true;\n      document.body.append(script);\n      script.onload = () => setSDKReady(true);\n    } catch (error) {\n      console.log(error);\n    }\n  }, [token]);\n\n  useEffect(() => {\n    (async () => {\n      if (token) {\n        await addPaypalScript();\n      }\n    })();\n  }, [token, addPaypalScript]);\n\n  useEffect(() => {\n    if (\n      !token ||\n      !cartItems ||\n      !selectedshipping ||\n      !selectedpayment ||\n      (cartItems && cartItems.length <= 0)\n    ) {\n      setDisableBtn(true);\n    }\n  }, [token, cartItems, selectedshipping, selectedpayment]);\n\n  useEffect(() => {\n    if (selectedshipping) {\n      const shipping = addressStringify(selectedshipping);\n      setSelShipping(shipping);\n    }\n  }, [selectedshipping]);\n\n  useEffect(() => {\n    if (selectedpayment) {\n      const payment = paymentMethodStringify(selectedpayment);\n      setSelPayment(payment);\n    }\n  }, [selectedpayment]);\n\n  useEffect(() => {\n    calculateTotal();\n    calculateShippingCost();\n  }, [cartItems, calculateTotal, calculateShippingCost]);\n\n  useEffect(() => {\n    calculateTax();\n  }, [total, calculateTax]);\n\n  useEffect(() => {\n    calculateSubTotal();\n  }, [total, tax, shippingCost, calculateSubTotal]);\n\n  useEffect(() => {\n    if (newOrderId) {\n      history.push(`/orders/${newOrderId}`);\n    }\n  }, [newOrderId, history]);\n\n  if (!SDKReady) {\n    return <LoadingLinear />;\n  }\n\n  return (\n    <Grid container spacing={2} className={classes.root}>\n      <Grid item md={8} sm={12} xs={12}>\n        <div className={classes.subRoot}>\n          <PageHeading text=\"SHIPPING ADDRESS\" paragraph size=\"medium\" />\n          {shippingLoading && <SkeletonProductDescription />}\n          {shippingError && (\n            <AlertMessage\n              message={shippingError}\n              severity=\"error\"\n              variant=\"outlined\"\n            />\n          )}\n          <Typography paragraph gutterBottom>\n            {selShipping}\n          </Typography>\n          <Divider />\n        </div>\n        <div className={classes.subRoot}>\n          <PageHeading text=\"PAYMENT METHOD\" paragraph size=\"medium\" />\n          {paymentLoading && <SkeletonPrice />}\n          {paymentError && (\n            <AlertMessage\n              message={paymentError}\n              severity=\"error\"\n              variant=\"outlined\"\n            />\n          )}\n          <Typography paragraph gutterBottom>\n            {selPayment}\n          </Typography>\n          <Divider />\n        </div>\n        <div>\n          <PageHeading text=\"ORDER ITEMS\" paragraph size=\"medium\" />\n          {cartLoading && <SkeletonCartBody />}\n          {cartError && (\n            <AlertMessage\n              message={cartError}\n              severity=\"error\"\n              variant=\"outlined\"\n            />\n          )}\n          {cartItems?.length > 0 ? (\n            <TableContainer>\n              <Table>\n                <TableHead>\n                  <TableRow>\n                    <Hidden xsDown>\n                      <TableCell></TableCell>\n                    </Hidden>\n                    <TableCell>Name</TableCell>\n                    <TableCell>Price</TableCell>\n                    <TableCell>Qty</TableCell>\n                    <TableCell></TableCell>\n                  </TableRow>\n                </TableHead>\n                <TableBody>\n                  {cartItems?.map(\n                    ({ id, name, price, imageUrl, countInStock, qty }) => {\n                      return (\n                        <TableRow key={id}>\n                          <Hidden xsDown>\n                            <TableCell>\n                              <Paper className={classes.paper} elevation={0}>\n                                <CardMedia\n                                  className={classes.media}\n                                  image={imageUrl || '/images/placeholder.jpg'}\n                                  title={name}\n                                />\n                              </Paper>\n                            </TableCell>\n                          </Hidden>\n                          <TableCell>{name}</TableCell>\n                          <TableCell>\n                            <span>\n                              {`${qty} x $${price} = `}\n                              <strong>{`$${total.toFixed(2)}`}</strong>\n                            </span>\n                          </TableCell>\n                          <TableCell>\n                            <FormControl variant=\"outlined\">\n                              <Select\n                                className={classes.select}\n                                native\n                                onChange={(event) =>\n                                  addToCartHandler(\n                                    id,\n                                    Number(event.target.value)\n                                  )\n                                }\n                                value={qty}\n                              >\n                                {[...Array(countInStock).keys()].map((num) => (\n                                  <option key={num} value={num + 1}>\n                                    {num + 1}\n                                  </option>\n                                ))}\n                              </Select>\n                            </FormControl>\n                          </TableCell>\n                          <TableCell>\n                            <Tooltip\n                              TransitionComponent={Zoom}\n                              title=\"Remove item\"\n                            >\n                              <IconButton\n                                color=\"inherit\"\n                                size=\"small\"\n                                onClick={() => removeFromCartHandler(id)}\n                              >\n                                <DeleteIcon />\n                              </IconButton>\n                            </Tooltip>\n                          </TableCell>\n                        </TableRow>\n                      );\n                    }\n                  )}\n                </TableBody>\n              </Table>\n            </TableContainer>\n          ) : (\n            <AlertMessage message=\"Cart is empty\" severity=\"info\" />\n          )}\n        </div>\n      </Grid>\n      <Grid item md={3} sm={12} xs={12}>\n        <PlaceOrderSummary\n          loading={cartLoading || shippingLoading || paymentLoading}\n          total={total?.toFixed(2)}\n          tax={tax?.toFixed(2)}\n          shippingCost={shippingCost?.toFixed(2)}\n          subTotal={subTotal?.toFixed(2)}\n          disable={disableBtn}\n          handleClick={handlePlaceOrder}\n        />\n      </Grid>\n    </Grid>\n  );\n};\n\nexport default PlaceOrder;\n"]},"metadata":{},"sourceType":"module"}