{"ast":null,"code":"import _regeneratorRuntime from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import*as req from'../actions/paymentActions';import{sendRequest}from'../../helpers';var clearLocalStorage=function clearLocalStorage(props){var shoppingapp=localStorage.getItem('shoppingapp');if(shoppingapp){shoppingapp=JSON.parse(shoppingapp);if(shoppingapp[props]){delete shoppingapp[props];}return localStorage.setItem('shoppingapp',JSON.stringify(shoppingapp));}};var updateLocalStorage=function updateLocalStorage(paymentMethods){var shoppingapp=localStorage.getItem('shoppingapp');if(shoppingapp){shoppingapp=JSON.parse(shoppingapp);if((paymentMethods===null||paymentMethods===void 0?void 0:paymentMethods.length)>0){return localStorage.setItem('shoppingapp',JSON.stringify(_objectSpread(_objectSpread({},shoppingapp),{},{paymentMethods:paymentMethods})));}delete shoppingapp.paymentMethods;return localStorage.setItem('shoppingapp',JSON.stringify(shoppingapp));}if(paymentMethods){localStorage.setItem('shoppingapp',JSON.stringify({paymentMethods:paymentMethods}));}};export var getPaymentMethods=function getPaymentMethods(userId,token){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch,getState){var _yield$sendRequest,error,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;dispatch({type:req.PAYMENT_METHODS_REQUEST});_context.next=4;return sendRequest(\"\".concat(process.env.REACT_APP_API_URL,\"/payment/users/\").concat(userId),'GET',{Authorization:\"Bearer \".concat(token)});case 4:_yield$sendRequest=_context.sent;error=_yield$sendRequest.error;data=_yield$sendRequest.data;if(!error){_context.next=9;break;}return _context.abrupt(\"return\",dispatch({type:req.PAYMENT_METHODS_FAILURE,payload:error}));case 9:dispatch({type:req.PAYMENT_METHODS_SUCCESS,payload:data});updateLocalStorage(getState().payment.paymentMethods);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function(_x,_x2){return _ref.apply(this,arguments);};}();};export var savePaymentMethod=function savePaymentMethod(userId,token,paymentInfo,onSuccess){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch,getState){var _yield$sendRequest2,error,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;dispatch({type:req.SAVE_PAYMENT_REQUEST});_context2.next=4;return sendRequest(\"\".concat(process.env.REACT_APP_API_URL,\"/payment/users/\").concat(userId,\"/new\"),'POST',{'Content-Type':'application/json',Authorization:\"Bearer \".concat(token)},JSON.stringify(paymentInfo));case 4:_yield$sendRequest2=_context2.sent;error=_yield$sendRequest2.error;data=_yield$sendRequest2.data;if(!error){_context2.next=9;break;}return _context2.abrupt(\"return\",dispatch({type:req.SAVE_PAYMENT_FAILURE,payload:error}));case 9:dispatch({type:req.SAVE_PAYMENT_SUCCESS,payload:data});updateLocalStorage(getState().payment.paymentMethods);onSuccess('saved');_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[0,14]]);}));return function(_x3,_x4){return _ref2.apply(this,arguments);};}();};export var removePaymentMethod=function removePaymentMethod(userId,token,paymentId,onSuccess){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch,getState){var _yield$sendRequest3,error,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;dispatch({type:req.REMOVE_PAYMENT_REQUEST});_context3.next=4;return sendRequest(\"\".concat(process.env.REACT_APP_API_URL,\"/payment/\").concat(paymentId,\"/users/\").concat(userId),'DELETE',{'Content-Type':'application/json',Authorization:\"Bearer \".concat(token)});case 4:_yield$sendRequest3=_context3.sent;error=_yield$sendRequest3.error;data=_yield$sendRequest3.data;if(!error){_context3.next=9;break;}return _context3.abrupt(\"return\",dispatch({type:req.REMOVE_PAYMENT_FAILURE,payload:error}));case 9:dispatch({type:req.REMOVE_PAYMENT_SUCCESS,payload:data});updateLocalStorage(getState().payment.paymentMethods);onSuccess('removed');_context3.next=17;break;case 14:_context3.prev=14;_context3.t0=_context3[\"catch\"](0);console.log(_context3.t0);case 17:case\"end\":return _context3.stop();}}},_callee3,null,[[0,14]]);}));return function(_x5,_x6){return _ref3.apply(this,arguments);};}();};export var removeAllPaymentMethods=function removeAllPaymentMethods(){return function(dispatch,getState){dispatch({type:req.REMOVE_ALL_PAYMENT});clearLocalStorage('paymentMethods');};};","map":{"version":3,"sources":["/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/src/redux/actionCreators/paymentActionCreators.js"],"names":["req","sendRequest","clearLocalStorage","props","shoppingapp","localStorage","getItem","JSON","parse","setItem","stringify","updateLocalStorage","paymentMethods","length","getPaymentMethods","userId","token","dispatch","getState","type","PAYMENT_METHODS_REQUEST","process","env","REACT_APP_API_URL","Authorization","error","data","PAYMENT_METHODS_FAILURE","payload","PAYMENT_METHODS_SUCCESS","payment","console","log","savePaymentMethod","paymentInfo","onSuccess","SAVE_PAYMENT_REQUEST","SAVE_PAYMENT_FAILURE","SAVE_PAYMENT_SUCCESS","removePaymentMethod","paymentId","REMOVE_PAYMENT_REQUEST","REMOVE_PAYMENT_FAILURE","REMOVE_PAYMENT_SUCCESS","removeAllPaymentMethods","REMOVE_ALL_PAYMENT"],"mappings":"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","sourcesContent":["import * as req from '../actions/paymentActions';\nimport { sendRequest } from '../../helpers';\n\nconst clearLocalStorage = (props) => {\n  let shoppingapp = localStorage.getItem('shoppingapp');\n  if (shoppingapp) {\n    shoppingapp = JSON.parse(shoppingapp);\n    if (shoppingapp[props]) {\n      delete shoppingapp[props];\n    }\n    return localStorage.setItem('shoppingapp', JSON.stringify(shoppingapp));\n  }\n};\n\nconst updateLocalStorage = (paymentMethods) => {\n  let shoppingapp = localStorage.getItem('shoppingapp');\n  if (shoppingapp) {\n    shoppingapp = JSON.parse(shoppingapp);\n    if (paymentMethods?.length > 0) {\n      return localStorage.setItem(\n        'shoppingapp',\n        JSON.stringify({ ...shoppingapp, paymentMethods })\n      );\n    }\n    delete shoppingapp.paymentMethods;\n    return localStorage.setItem('shoppingapp', JSON.stringify(shoppingapp));\n  }\n  if (paymentMethods) {\n    localStorage.setItem('shoppingapp', JSON.stringify({ paymentMethods }));\n  }\n};\n\nexport const getPaymentMethods =\n  (userId, token) => async (dispatch, getState) => {\n    try {\n      dispatch({ type: req.PAYMENT_METHODS_REQUEST });\n      const { error, data } = await sendRequest(\n        `${process.env.REACT_APP_API_URL}/payment/users/${userId}`,\n        'GET',\n        { Authorization: `Bearer ${token}` }\n      );\n      if (error) {\n        return dispatch({ type: req.PAYMENT_METHODS_FAILURE, payload: error });\n      }\n      dispatch({ type: req.PAYMENT_METHODS_SUCCESS, payload: data });\n      updateLocalStorage(getState().payment.paymentMethods);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\nexport const savePaymentMethod =\n  (userId, token, paymentInfo, onSuccess) => async (dispatch, getState) => {\n    try {\n      dispatch({ type: req.SAVE_PAYMENT_REQUEST });\n      const { error, data } = await sendRequest(\n        `${process.env.REACT_APP_API_URL}/payment/users/${userId}/new`,\n        'POST',\n        {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${token}`,\n        },\n        JSON.stringify(paymentInfo)\n      );\n      if (error) {\n        return dispatch({ type: req.SAVE_PAYMENT_FAILURE, payload: error });\n      }\n      dispatch({ type: req.SAVE_PAYMENT_SUCCESS, payload: data });\n      updateLocalStorage(getState().payment.paymentMethods);\n      onSuccess('saved');\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\nexport const removePaymentMethod =\n  (userId, token, paymentId, onSuccess) => async (dispatch, getState) => {\n    try {\n      dispatch({ type: req.REMOVE_PAYMENT_REQUEST });\n      const { error, data } = await sendRequest(\n        `${process.env.REACT_APP_API_URL}/payment/${paymentId}/users/${userId}`,\n        'DELETE',\n        { 'Content-Type': 'application/json', Authorization: `Bearer ${token}` }\n      );\n      if (error) {\n        return dispatch({ type: req.REMOVE_PAYMENT_FAILURE, payload: error });\n      }\n      dispatch({ type: req.REMOVE_PAYMENT_SUCCESS, payload: data });\n      updateLocalStorage(getState().payment.paymentMethods);\n      onSuccess('removed');\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\nexport const removeAllPaymentMethods = () => (dispatch, getState) => {\n  dispatch({ type: req.REMOVE_ALL_PAYMENT });\n  clearLocalStorage('paymentMethods');\n};\n"]},"metadata":{},"sourceType":"module"}