{"ast":null,"code":"import _toConsumableArray from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _defineProperty from\"/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import React,{useState,useEffect,useCallback}from'react';import{useLocation,useParams,useHistory}from'react-router-dom';import{useDispatch,useSelector}from'react-redux';import AlertMessage from'../../shared/ui/AlertMessage';import{addToCart,removeFromCart}from'../../../redux/actionCreators/cartActionCreators';import SkeletonCart from'../../shared/ui/skeletons/SkeletonCart';import{makeStyles}from'@material-ui/core/styles';import Hidden from'@material-ui/core/Hidden';import Grid from'@material-ui/core/Grid';import TableContainer from'@material-ui/core/TableContainer';import Table from'@material-ui/core/Table';import TableHead from'@material-ui/core/TableHead';import TableBody from'@material-ui/core/TableBody';import TableRow from'@material-ui/core/TableRow';import TableCell from'@material-ui/core/TableCell';import Paper from'@material-ui/core/Paper';import CardMedia from'@material-ui/core/CardMedia';import IconButton from'@material-ui/core/IconButton';import FormControl from'@material-ui/core/FormControl';import Select from'@material-ui/core/Select';import Tooltip from'@material-ui/core/Tooltip';import Zoom from'@material-ui/core/Zoom';import PageHeading from'../../shared/ui/PageHeading';import CartTotal from'../components/CartTotal';import DeleteIcon from'@material-ui/icons/Delete';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles(function(theme){return{root:_defineProperty({},theme.breakpoints.down('lg'),{justifyContent:'flex-end'}),paper:{width:theme.spacing(20),height:theme.spacing(13)},media:{width:'100%',height:'100%'},select:_defineProperty({},theme.breakpoints.down('xs'),{width:theme.spacing(4),height:theme.spacing(4),fontSize:'13px','&>svg':{display:'none'}})};});var Cart=function Cart(){var classes=useStyles();var history=useHistory();var pid=useParams().pid;var location=useLocation().search;var query=location?new URLSearchParams(location):null;var qty=(query===null||query===void 0?void 0:query.has('qty'))?Number(query.get('qty')):1;var dispatch=useDispatch();var _useSelector=useSelector(function(state){return state.userAuth;}),loggedInUser=_useSelector.loggedInUser;var _useSelector2=useSelector(function(state){return state.cart;}),loading=_useSelector2.loading,error=_useSelector2.error,cartItems=_useSelector2.cartItems;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),showTotalHeader=_useState2[0],setShowTotalHeader=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),subTotal=_useState4[0],setSubTotal=_useState4[1];var addToCartHandler=useCallback(function(pid,qty){dispatch(addToCart(pid,qty));},[dispatch]);var removeFromCartHandler=function removeFromCartHandler(pid){dispatch(removeFromCart(pid));};var calculateSubTotal=function calculateSubTotal(cartItems){var total=cartItems.reduce(function(acc,product){return product.price*product.qty+acc;},0).toFixed(2);setSubTotal(total);};var checkoutHandler=function checkoutHandler(){history.push(loggedInUser?'/checkout':\"/auth?redirect=checkout\");};useEffect(function(){if(pid&&qty){addToCartHandler(pid,qty);}},[pid,qty,addToCartHandler]);useEffect(function(){if(cartItems){setShowTotalHeader(cartItems.some(function(item){return item.qty>1;}));calculateSubTotal(cartItems);}},[cartItems]);if(loading){return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(PageHeading,{text:\"SHOPPING CART\",gutterBottom:true}),/*#__PURE__*/_jsx(SkeletonCart,{})]});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(PageHeading,{text:\"SHOPPING CART\",gutterBottom:true}),error&&/*#__PURE__*/_jsx(AlertMessage,{message:error,severity:\"error\",variant:\"outlined\"}),cartItems===null||cartItems===undefined?null:cartItems.length<=0?/*#__PURE__*/_jsx(AlertMessage,{message:\"CART IS EMPTY\",severity:\"info\",variant:\"outlined\"}):/*#__PURE__*/_jsxs(Grid,{container:true,spacing:1,className:classes.root,children:[/*#__PURE__*/_jsx(Grid,{item:true,md:9,xs:12,children:/*#__PURE__*/_jsx(TableContainer,{children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(Hidden,{xsDown:true,children:/*#__PURE__*/_jsx(TableCell,{})}),/*#__PURE__*/_jsx(TableCell,{children:\"Name\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Price\"}),/*#__PURE__*/_jsx(TableCell,{align:\"center\",children:\"Qty\"}),showTotalHeader&&/*#__PURE__*/_jsx(Hidden,{xsDown:true,children:/*#__PURE__*/_jsx(TableCell,{children:\"Total\"})}),/*#__PURE__*/_jsx(TableCell,{})]})}),/*#__PURE__*/_jsx(TableBody,{children:cartItems===null||cartItems===void 0?void 0:cartItems.map(function(_ref){var id=_ref.id,name=_ref.name,price=_ref.price,imageUrl=_ref.imageUrl,countInStock=_ref.countInStock,qty=_ref.qty;return/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(Hidden,{xsDown:true,children:/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Paper,{className:classes.paper,elevation:0,children:/*#__PURE__*/_jsx(CardMedia,{className:classes.media,image:imageUrl||'/images/placeholder.jpg',title:name})})})}),/*#__PURE__*/_jsx(TableCell,{children:name}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"$\",price]})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(FormControl,{variant:\"outlined\",children:/*#__PURE__*/_jsx(Select,{className:classes.select,native:true,onChange:function onChange(event){return addToCartHandler(id,Number(event.target.value));},value:qty,children:_toConsumableArray(Array(countInStock).keys()).map(function(num){return/*#__PURE__*/_jsx(\"option\",{value:num+1,children:num+1},num);})})})}),showTotalHeader&&/*#__PURE__*/_jsx(Hidden,{xsDown:true,children:/*#__PURE__*/_jsx(TableCell,{children:qty>1?/*#__PURE__*/_jsxs(\"strong\",{children:[\"$\",(price*qty).toFixed(2)]}):''})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Tooltip,{TransitionComponent:Zoom,title:\"Remove item\",children:/*#__PURE__*/_jsx(IconButton,{color:\"inherit\",size:\"small\",onClick:function onClick(){return removeFromCartHandler(id);},children:/*#__PURE__*/_jsx(DeleteIcon,{})})})})]},id);})})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,md:3,sm:7,xs:12,children:/*#__PURE__*/_jsx(CartTotal,{subTotal:subTotal,totalQty:cartItems===null||cartItems===void 0?void 0:cartItems.length,checkoutHandler:checkoutHandler})})]})]});};export default Cart;","map":{"version":3,"sources":["/Users/tmak/Desktop/tei/udemy/brdtrv/ecomm/client/src/components/products/pages/Cart.js"],"names":["React","useState","useEffect","useCallback","useLocation","useParams","useHistory","useDispatch","useSelector","AlertMessage","addToCart","removeFromCart","SkeletonCart","makeStyles","Hidden","Grid","TableContainer","Table","TableHead","TableBody","TableRow","TableCell","Paper","CardMedia","IconButton","FormControl","Select","Tooltip","Zoom","PageHeading","CartTotal","DeleteIcon","useStyles","theme","root","breakpoints","down","justifyContent","paper","width","spacing","height","media","select","fontSize","display","Cart","classes","history","pid","location","search","query","URLSearchParams","qty","has","Number","get","dispatch","state","userAuth","loggedInUser","cart","loading","error","cartItems","showTotalHeader","setShowTotalHeader","subTotal","setSubTotal","addToCartHandler","removeFromCartHandler","calculateSubTotal","total","reduce","acc","product","price","toFixed","checkoutHandler","push","some","item","undefined","length","map","id","name","imageUrl","countInStock","event","target","value","Array","keys","num"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useLocation, useParams, useHistory } from 'react-router-dom';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport AlertMessage from '../../shared/ui/AlertMessage';\n\nimport {\n  addToCart,\n  removeFromCart,\n} from '../../../redux/actionCreators/cartActionCreators';\n\nimport SkeletonCart from '../../shared/ui/skeletons/SkeletonCart';\n\nimport { makeStyles } from '@material-ui/core/styles';\nimport Hidden from '@material-ui/core/Hidden';\nimport Grid from '@material-ui/core/Grid';\nimport TableContainer from '@material-ui/core/TableContainer';\nimport Table from '@material-ui/core/Table';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableRow from '@material-ui/core/TableRow';\nimport TableCell from '@material-ui/core/TableCell';\nimport Paper from '@material-ui/core/Paper';\nimport CardMedia from '@material-ui/core/CardMedia';\nimport IconButton from '@material-ui/core/IconButton';\nimport FormControl from '@material-ui/core/FormControl';\nimport Select from '@material-ui/core/Select';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Zoom from '@material-ui/core/Zoom';\n\nimport PageHeading from '../../shared/ui/PageHeading';\nimport CartTotal from '../components/CartTotal';\n\nimport DeleteIcon from '@material-ui/icons/Delete';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    [theme.breakpoints.down('lg')]: {\n      justifyContent: 'flex-end',\n    },\n  },\n  paper: {\n    width: theme.spacing(20),\n    height: theme.spacing(13),\n  },\n  media: {\n    width: '100%',\n    height: '100%',\n  },\n  select: {\n    [theme.breakpoints.down('xs')]: {\n      width: theme.spacing(4),\n      height: theme.spacing(4),\n      fontSize: '13px',\n      '&>svg': {\n        display: 'none',\n      },\n    },\n  },\n}));\n\nconst Cart = () => {\n  const classes = useStyles();\n  const history = useHistory();\n  const pid = useParams().pid;\n\n  const location = useLocation().search;\n  const query = location ? new URLSearchParams(location) : null;\n  const qty = query?.has('qty') ? Number(query.get('qty')) : 1;\n\n  const dispatch = useDispatch();\n  const { loggedInUser } = useSelector((state) => state.userAuth);\n  const { loading, error, cartItems } = useSelector((state) => state.cart);\n  const [showTotalHeader, setShowTotalHeader] = useState(false);\n  const [subTotal, setSubTotal] = useState(0);\n\n  const addToCartHandler = useCallback(\n    (pid, qty) => {\n      dispatch(addToCart(pid, qty));\n    },\n    [dispatch]\n  );\n  const removeFromCartHandler = (pid) => {\n    dispatch(removeFromCart(pid));\n  };\n\n  const calculateSubTotal = (cartItems) => {\n    let total = cartItems\n      .reduce((acc, product) => {\n        return product.price * product.qty + acc;\n      }, 0)\n      .toFixed(2);\n    setSubTotal(total);\n  };\n\n  const checkoutHandler = () => {\n    history.push(loggedInUser ? '/checkout' : `/auth?redirect=checkout`);\n  };\n\n  useEffect(() => {\n    if (pid && qty) {\n      addToCartHandler(pid, qty);\n    }\n  }, [pid, qty, addToCartHandler]);\n\n  useEffect(() => {\n    if (cartItems) {\n      setShowTotalHeader(cartItems.some((item) => item.qty > 1));\n      calculateSubTotal(cartItems);\n    }\n  }, [cartItems]);\n\n  if (loading) {\n    return (\n      <>\n        <PageHeading text=\"SHOPPING CART\" gutterBottom />\n        <SkeletonCart />\n      </>\n    );\n  }\n  return (\n    <>\n      <PageHeading text=\"SHOPPING CART\" gutterBottom />\n      {error && (\n        <AlertMessage message={error} severity=\"error\" variant=\"outlined\" />\n      )}\n      {cartItems === null ||\n      cartItems === undefined ? null : cartItems.length <= 0 ? (\n        <AlertMessage\n          message=\"CART IS EMPTY\"\n          severity=\"info\"\n          variant=\"outlined\"\n        />\n      ) : (\n        <Grid container spacing={1} className={classes.root}>\n          <Grid item md={9} xs={12}>\n            <TableContainer>\n              <Table>\n                <TableHead>\n                  <TableRow>\n                    <Hidden xsDown>\n                      <TableCell></TableCell>\n                    </Hidden>\n                    <TableCell>Name</TableCell>\n                    <TableCell>Price</TableCell>\n                    <TableCell align=\"center\">Qty</TableCell>\n                    {showTotalHeader && (\n                      <Hidden xsDown>\n                        <TableCell>Total</TableCell>\n                      </Hidden>\n                    )}\n                    <TableCell></TableCell>\n                  </TableRow>\n                </TableHead>\n                <TableBody>\n                  {cartItems?.map(\n                    ({ id, name, price, imageUrl, countInStock, qty }) => {\n                      return (\n                        <TableRow key={id}>\n                          <Hidden xsDown>\n                            <TableCell>\n                              <Paper className={classes.paper} elevation={0}>\n                                <CardMedia\n                                  className={classes.media}\n                                  image={imageUrl || '/images/placeholder.jpg'}\n                                  title={name}\n                                />\n                              </Paper>\n                            </TableCell>\n                          </Hidden>\n                          <TableCell>{name}</TableCell>\n                          <TableCell>\n                            <strong>${price}</strong>\n                          </TableCell>\n                          <TableCell>\n                            <FormControl variant=\"outlined\">\n                              <Select\n                                className={classes.select}\n                                native\n                                onChange={(event) =>\n                                  addToCartHandler(\n                                    id,\n                                    Number(event.target.value)\n                                  )\n                                }\n                                value={qty}\n                              >\n                                {[...Array(countInStock).keys()].map((num) => (\n                                  <option key={num} value={num + 1}>\n                                    {num + 1}\n                                  </option>\n                                ))}\n                              </Select>\n                            </FormControl>\n                          </TableCell>\n                          {showTotalHeader && (\n                            <Hidden xsDown>\n                              <TableCell>\n                                {qty > 1 ? (\n                                  <strong>${(price * qty).toFixed(2)}</strong>\n                                ) : (\n                                  ''\n                                )}\n                              </TableCell>\n                            </Hidden>\n                          )}\n                          <TableCell>\n                            <Tooltip\n                              TransitionComponent={Zoom}\n                              title=\"Remove item\"\n                            >\n                              <IconButton\n                                color=\"inherit\"\n                                size=\"small\"\n                                onClick={() => removeFromCartHandler(id)}\n                              >\n                                <DeleteIcon />\n                              </IconButton>\n                            </Tooltip>\n                          </TableCell>\n                        </TableRow>\n                      );\n                    }\n                  )}\n                </TableBody>\n              </Table>\n            </TableContainer>\n          </Grid>\n          <Grid item md={3} sm={7} xs={12}>\n            <CartTotal\n              subTotal={subTotal}\n              totalQty={cartItems?.length}\n              checkoutHandler={checkoutHandler}\n            />\n          </Grid>\n        </Grid>\n      )}\n    </>\n  );\n};\n\nexport default Cart;\n"]},"metadata":{},"sourceType":"module"}